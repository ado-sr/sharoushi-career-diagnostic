<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¤¾åŠ´å£«ã‚­ãƒ£ãƒªã‚¢è¨ºæ–­ | ScheinÃ—Hollandç†è«–ã«åŸºã¥ãç§‘å­¦çš„è¨ºæ–­ | ç¤¾åŠ´å£«Lab</title>
    <meta name="description"
        content="MITæ•™æˆãŒé–‹ç™ºã—ãŸã‚­ãƒ£ãƒªã‚¢ãƒ»ã‚¢ãƒ³ã‚«ãƒ¼ç†è«–ã¨ä¸–ç•Œæ¨™æº–ã®RIASECç†è«–ã«åŸºã¥ãã€ã‚¨ãƒ“ãƒ‡ãƒ³ã‚¹ãƒ™ãƒ¼ã‚¹ã®ç¤¾åŠ´å£«ã‚­ãƒ£ãƒªã‚¢è¨ºæ–­ã€‚ãŸã£ãŸ3åˆ†ã§ã€ã‚ãªãŸã«æœ€é©ãªã‚­ãƒ£ãƒªã‚¢ãƒ‘ã‚¹ãŒè¦‹ã¤ã‹ã‚Šã¾ã™ã€‚">
    <meta name="keywords" content="ç¤¾åŠ´å£«,ã‚­ãƒ£ãƒªã‚¢è¨ºæ–­,ã‚­ãƒ£ãƒªã‚¢ã‚¢ãƒ³ã‚«ãƒ¼,Schein,Holland,RIASEC,è·æ¥­é©æ€§,ç¤¾åŠ´å£«Lab">
    <meta property="og:title" content="ç¤¾åŠ´å£«ã‚­ãƒ£ãƒªã‚¢è¨ºæ–­ | ScheinÃ—Hollandç†è«–ã«åŸºã¥ãç§‘å­¦çš„è¨ºæ–­">
    <meta property="og:description"
        content="MITæ•™æˆãŒé–‹ç™ºã—ãŸã‚­ãƒ£ãƒªã‚¢ãƒ»ã‚¢ãƒ³ã‚«ãƒ¼ç†è«–Ã—ä¸–ç•Œæ¨™æº–ã®RIASECç†è«–ã€‚ç§‘å­¦çš„æ ¹æ‹ ã«åŸºã¥ãã‚¨ãƒ“ãƒ‡ãƒ³ã‚¹ãƒ™ãƒ¼ã‚¹ã®è¨ºæ–­ã§ã€ã‚ãªãŸã«æœ€é©ãªç¤¾åŠ´å£«ã‚­ãƒ£ãƒªã‚¢ãƒ‘ã‚¹ã‚’ç™ºè¦‹ã€‚">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://srlab-career.netlify.app/">
    <meta property="og:image" content="https://srlab-career.netlify.app/ogp-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ç¤¾åŠ´å£«ã‚­ãƒ£ãƒªã‚¢è¨ºæ–­ | ScheinÃ—Hollandç†è«–ã«åŸºã¥ãç§‘å­¦çš„è¨ºæ–­">
    <meta name="twitter:description" content="MITæ•™æˆãŒé–‹ç™ºã—ãŸã‚­ãƒ£ãƒªã‚¢ç†è«–Ã—ä¸–ç•Œæ¨™æº–ã®è·æ¥­èˆˆå‘³ç†è«–ã€‚ãŸã£ãŸ3åˆ†ã§æœ€é©ãªã‚­ãƒ£ãƒªã‚¢ãƒ‘ã‚¹ãŒã‚ã‹ã‚‹ï¼">
    <meta name="twitter:image" content="https://srlab-career.netlify.app/ogp-image.png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #0066FF;
            --secondary: #00C896;
            --accent: #FF6B6B;
            --dark: #1A1A1A;
            --light: #F8F9FA;
            --border: #E5E5E5;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans JP", sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            line-height: 1.6;
        }

        /* Combat Power Styles */
        .combat-power-section {
            background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
            color: white;
            padding: 32px 20px;
            border-radius: 20px;
            margin: 0 0 32px 0;
            text-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
            border: 1px solid #333;
        }

        .combat-power-section::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, #FF6B6B, #FFD700, #00C896, #0066FF);
        }

        .combat-power-label {
            font-size: 14px;
            color: #aaa;
            letter-spacing: 3px;
            margin-bottom: 4px;
            font-weight: 700;
            text-transform: uppercase;
        }

        .combat-power-value {
            font-size: 56px;
            font-weight: 900;
            color: #FFD700;
            text-shadow: 0 0 25px rgba(255, 215, 0, 0.4);
            font-family: "Impact", "Arial Black", sans-serif;
            line-height: 1.1;
            margin: 8px 0;
        }

        .rank-badge-bg {
            position: absolute;
            top: 50%;
            right: 10px;
            font-size: 120px;
            font-weight: 900;
            color: rgba(255, 255, 255, 0.05);
            transform: translateY(-50%) rotate(10deg);
            pointer-events: none;
            font-family: "Impact", sans-serif;
        }

        .rank-display {
            display: inline-block;
            background: rgba(255, 255, 255, 0.1);
            padding: 6px 16px;
            border-radius: 100px;
            font-size: 16px;
            font-weight: 700;
            margin-top: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .rank-s {
            color: #FFD700;
            border-color: #FFD700;
            background: rgba(255, 215, 0, 0.1);
        }

        .rank-a {
            color: #FF6B6B;
            border-color: #FF6B6B;
            background: rgba(255, 107, 107, 0.1);
        }

        .rank-b {
            color: #00C896;
            border-color: #00C896;
            background: rgba(0, 200, 150, 0.1);
        }

        .container {
            max-width: 600px;
            width: 100%;
            background: white;
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
                box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
            }

            50% {
                transform: scale(1.05);
                box-shadow: 0 6px 25px rgba(255, 107, 107, 0.6);
            }
        }

        @keyframes sparkle {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.6;
            }
        }

        .logo {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo h1 {
            font-size: 28px;
            font-weight: 800;
            color: var(--dark);
            margin-bottom: 8px;
        }

        .logo p {
            color: #666;
            font-size: 14px;
        }

        .start-screen {
            text-align: center;
        }

        .start-screen h2 {
            font-size: 32px;
            font-weight: 800;
            color: var(--dark);
            margin-bottom: 16px;
            line-height: 1.3;
        }

        .start-screen p {
            font-size: 18px;
            color: #666;
            margin-bottom: 32px;
        }

        .theory-badge {
            display: inline-block;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 8px 20px;
            border-radius: 100px;
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 24px;
            box-shadow: 0 4px 15px rgba(0, 102, 255, 0.2);
        }

        .theory-highlights {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 24px;
            margin: 32px 0;
            padding: 24px;
            background: linear-gradient(135deg, #f8f9ff, #fff5f8);
            border-radius: 16px;
            border: 2px solid #e8eeff;
        }

        .theory-item {
            text-align: center;
        }

        .theory-icon {
            font-size: 36px;
            margin-bottom: 8px;
        }

        .theory-name {
            font-size: 13px;
            font-weight: 700;
            color: var(--dark);
            line-height: 1.5;
        }

        .theory-divider {
            font-size: 24px;
            font-weight: 700;
            color: var(--accent);
        }

        .theory-description {
            font-size: 14px;
            color: #555;
            line-height: 1.8;
            margin-bottom: 32px;
            padding: 0 16px;
        }

        .btn {
            display: inline-block;
            padding: 18px 48px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 100px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .btn:hover {
            background: #0052cc;
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(0, 102, 255, 0.3);
        }

        .btn-secondary {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-secondary:hover {
            background: var(--primary);
            color: white;
        }

        .progress-container {
            margin-bottom: 30px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--border);
            border-radius: 100px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 100px;
            transition: width 0.4s ease;
        }

        .progress-text {
            text-align: center;
            font-size: 14px;
            color: #666;
            font-weight: 600;
        }

        .question-screen {
            display: none;
        }

        .question-screen.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .question-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 32px;
            line-height: 1.4;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .option {
            padding: 20px;
            background: var(--light);
            border: 2px solid var(--border);
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            font-weight: 500;
            color: var(--dark);
        }

        .option:hover {
            border-color: var(--primary);
            background: #f0f7ff;
            transform: translateX(4px);
        }

        .option.selected {
            border-color: var(--primary);
            background: var(--primary);
            color: white;
        }

        .result-screen {
            display: none;
            text-align: center;
        }

        .result-screen.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .result-icon {
            font-size: 80px;
            margin-bottom: 24px;
        }

        .result-type {
            font-size: 36px;
            font-weight: 800;
            color: var(--dark);
            margin-bottom: 16px;
        }

        .result-description {
            font-size: 18px;
            color: #666;
            margin-bottom: 32px;
            line-height: 1.8;
        }

        .result-details {
            background: var(--light);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
            text-align: left;
        }

        .result-details h3 {
            font-size: 20px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 16px;
        }

        .result-details ul {
            list-style: none;
            padding-left: 0;
        }

        .result-details li {
            padding: 8px 0;
            padding-left: 28px;
            position: relative;
            color: #444;
        }

        .result-details li::before {
            content: "âœ“";
            position: absolute;
            left: 0;
            color: var(--secondary);
            font-weight: 700;
        }

        .cta-section {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 24px;
            color: white;
        }

        .cta-section h3 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .cta-section p {
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .share-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-top: 24px;
        }

        .share-btn {
            padding: 12px 24px;
            border-radius: 100px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }

        .share-twitter {
            background: #1DA1F2;
            color: white;
        }

        .share-line {
            background: #06C755;
            color: white;
        }

        .share-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        }

        .retry-btn {
            margin-top: 16px;
            font-size: 16px;
            padding: 14px 32px;
        }

        @media (max-width: 640px) {
            .container {
                padding: 24px;
            }

            .start-screen h2 {
                font-size: 24px;
            }

            .question-title {
                font-size: 20px;
            }

            .result-type {
                font-size: 28px;
            }

            .btn {
                width: 100%;
            }
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="logo">
            <h1>ç¤¾åŠ´å£«Lab</h1>
            <p>ã‚­ãƒ£ãƒªã‚¢è¨ºæ–­ãƒ„ãƒ¼ãƒ«</p>
        </div>

        <div class="start-screen" id="startScreen">
            <div class="theory-badge">
                ğŸ“š ç§‘å­¦çš„æ ¹æ‹ ã«åŸºã¥ãè¨ºæ–­
            </div>
            <h2>ã‚ãªãŸã«æœ€é©ãª<br>ç¤¾åŠ´å£«ã‚­ãƒ£ãƒªã‚¢ã¯ï¼Ÿ</h2>
            <p>ã‚ãªãŸã®çŠ¶æ³ã«åˆã‚ã›ãŸè³ªå•ã§ã€<br>ç†æƒ³ã®åƒãæ–¹ãŒè¦‹ã¤ã‹ã‚Šã¾ã™</p>

            <div class="theory-highlights">
                <div class="theory-item">
                    <div class="theory-icon">ğŸ“</div>
                    <div class="theory-name">Schein<br>ã‚­ãƒ£ãƒªã‚¢ãƒ»ã‚¢ãƒ³ã‚«ãƒ¼ç†è«–</div>
                </div>
                <div class="theory-divider">Ã—</div>
                <div class="theory-item">
                    <div class="theory-icon">ğŸ”¬</div>
                    <div class="theory-name">Holland<br>RIASECç†è«–</div>
                </div>
            </div>

            <div class="theory-description">
                MITæ•™æˆãŒé–‹ç™ºã—ãŸã‚­ãƒ£ãƒªã‚¢ä¾¡å€¤è¦³åˆ†é¡ã¨ã€<br>
                ä¸–ç•Œæ¨™æº–ã®è·æ¥­èˆˆå‘³ç†è«–ã‚’çµ±åˆã—ãŸ<br>
                ã‚¨ãƒ“ãƒ‡ãƒ³ã‚¹ãƒ™ãƒ¼ã‚¹ã®è¨ºæ–­ãƒ„ãƒ¼ãƒ«ã§ã™
            </div>

            <div style="margin: 24px 0;">
                <div style="width: 100%; max-width: 400px; margin: 0 auto;">
                    <input type="text" id="twitterUsernameInput" placeholder="ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚’å…¥åŠ›ï¼ˆä¾‹: ç”°ä¸­å¤ªéƒï¼‰"
                        style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 100px; font-size: 14px; text-align: center; outline: none; transition: border-color 0.3s;"
                        onfocus="this.style.borderColor='#0066FF'" onblur="this.style.borderColor='#e0e0e0'">
                </div>
                <div style="font-size: 12px; color: #888; margin-top: 8px;">è¨ºæ–­çµæœã«è¡¨ç¤ºã•ã‚Œã¾ã™ï¼ˆä»»æ„ãƒ»ç©ºæ¬„ã§ã‚‚OKï¼‰</div>
            </div>

            <button class="btn" onclick="startQuiz()">è¨ºæ–­ã‚’ã¯ã˜ã‚ã‚‹ï¼ˆç„¡æ–™ãƒ»ç´„3åˆ†ï¼‰</button>
        </div>

        <div class="progress-container hidden" id="progressContainer">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text">
                è³ªå• <span id="currentQuestion">0</span> / <span id="totalQuestions">24</span>
            </div>
        </div>

        <div id="questionContainer"></div>

        <div class="result-screen" id="resultScreen">
            <!-- ãƒ¬ã‚¢åº¦è¡¨ç¤ºï¼ˆç›®ç«‹ã¤æ¼”å‡ºï¼‰ -->
            <div style="text-align: center; margin-bottom: 24px;">
                <div id="rarityBadge"
                    style="display: inline-block; padding: 8px 24px; border-radius: 100px; font-size: 14px; font-weight: 800; color: white; background: linear-gradient(135deg, #FF6B6B, #FF8E53); box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4); animation: pulse 2s infinite;">
                    â­ æ¿€ãƒ¬ã‚¢ â­
                </div>
                <div style="font-size: 13px; color: #666; margin-top: 8px;">
                    ã“ã®ã‚¿ã‚¤ãƒ—ã¯å…¨ä½“ã® <span id="rarityPercent"
                        style="font-weight: 800; font-size: 18px; color: #FF6B6B;">10%</span> ã ã‘ï¼
                </div>
            </div>

            <!-- æˆ¦é—˜åŠ›è¡¨ç¤ºã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
            <div class="combat-power-section">
                <div class="rank-badge-bg" id="rankBg">S</div>
                <div class="combat-power-label">POTENTIAL POWER</div>
                <div class="combat-power-value" id="combatPowerValue">0</div>
                <div class="rank-display" id="rankDisplay">RANK A - ä¸Šç´šç¤¾åŠ´å£«ã‚¯ãƒ©ã‚¹</div>
                <div style="font-size: 10px; color: #666; margin-top: 8px;">â€»ã“ã®æ•°å€¤ã¯ã‚¸ãƒ§ãƒ¼ã‚¯ã§ã™ã€‚å®Ÿéš›ã®èƒ½åŠ›ã‚’ä¿è¨¼ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</div>
            </div>

            <div class="result-icon" id="resultIcon"></div>
            <div class="result-type" id="resultType"></div>

            <!-- ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ è¡¨ç¤º -->
            <div id="nicknameDisplay"
                style="text-align: center; font-size: 16px; color: #555; margin: 12px 0; font-weight: 600;"></div>

            <!-- ç§°å·ãƒãƒƒã‚¸ -->
            <div style="text-align: center; margin: 16px 0;">
                <div id="badgeDisplay" style="font-size: 20px; font-weight: 700; color: var(--primary);">
                    ğŸ’ ãƒ“ã‚¸ãƒ§ãƒŠãƒªãƒ¼ãƒ»ãƒªãƒ¼ãƒ€ãƒ¼
                </div>
            </div>

            <!-- ã‚­ãƒ£ãƒƒãƒãƒ•ãƒ¬ãƒ¼ã‚º -->
            <div id="catchPhrase"
                style="text-align: center; font-size: 18px; font-weight: 700; color: #FF6B6B; margin-bottom: 16px; padding: 12px; background: linear-gradient(135deg, #fff5f5, #fff8e1); border-radius: 12px; border: 2px dashed #FF6B6B;">
                æ¬¡ä¸–ä»£ã‚’å‰µã‚‹èµ·æ¥­å®¶ãƒã‚¤ãƒ³ãƒ‰ã®æŒã¡ä¸»ï¼
            </div>

            <div class="result-description" id="resultDescription"></div>

            <!-- ãƒã‚¤ãƒ©ãƒ«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
            <div id="viralMessage"
                style="text-align: center; font-size: 16px; font-weight: 600; color: var(--dark); margin: 20px 0; padding: 16px; background: linear-gradient(135deg, #f0f9ff, #fef3f0); border-radius: 12px; border-left: 4px solid var(--primary);">
                é‡å¿ƒã¨è¡Œå‹•åŠ›ã‚’å…¼ã­å‚™ãˆãŸç¨€å°‘äººæï¼ã‚ãªãŸã¯å…¨ä½“ã®ã‚ãšã‹10%ğŸ’«
            </div>

            <div class="result-details">
                <h3>ã‚ãªãŸã®ç‰¹å¾´</h3>
                <ul id="resultTraits"></ul>
            </div>

            <div class="result-details"
                style="background: linear-gradient(135deg, #f0f7ff, #fff5f0); border: 2px solid #e0f0ff;">
                <h3>ğŸ“Š ã‚ãªãŸã®RIASECã‚³ãƒ¼ãƒ‰ï¼ˆHollandç†è«–ï¼‰</h3>
                <div style="text-align: center; margin: 16px 0;">
                    <div style="font-size: 32px; font-weight: 800; color: var(--primary); margin-bottom: 8px;"
                        id="riasecCode">S-E-I</div>
                    <div style="font-size: 14px; color: #666;" id="riasecDetails">S(12ç‚¹) E(10ç‚¹) I(8ç‚¹)</div>
                </div>

                <!-- RIASECå…­è§’å½¢ãƒãƒ£ãƒ¼ãƒˆ -->
                <div style="display: flex; justify-content: center; margin: 24px 0;">
                    <svg id="riasecHexagon" width="280" height="280" viewBox="0 0 280 280">
                        <!-- èƒŒæ™¯ã‚°ãƒªãƒƒãƒ‰ -->
                        <polygon points="140,40 210,85 210,175 140,220 70,175 70,85" fill="none" stroke="#e0e0e0"
                            stroke-width="1.5" />
                        <polygon points="140,70 190,100 190,160 140,190 90,160 90,100" fill="none" stroke="#e0e0e0"
                            stroke-width="1.5" />
                        <polygon points="140,100 170,115 170,145 140,160 110,145 110,115" fill="none" stroke="#e0e0e0"
                            stroke-width="1.5" />

                        <!-- ãƒ‡ãƒ¼ã‚¿å¤šè§’å½¢ -->
                        <polygon id="riasecDataPolygon" points="140,40 210,85 210,175 140,220 70,175 70,85"
                            fill="rgba(0, 102, 255, 0.2)" stroke="#0066FF" stroke-width="2.5" />

                        <!-- ãƒ©ãƒ™ãƒ« -->
                        <text x="140" y="30" text-anchor="middle" font-size="14" font-weight="700" fill="#333">R</text>
                        <text x="225" y="90" text-anchor="start" font-size="14" font-weight="700" fill="#333">I</text>
                        <text x="225" y="180" text-anchor="start" font-size="14" font-weight="700" fill="#333">A</text>
                        <text x="140" y="240" text-anchor="middle" font-size="14" font-weight="700" fill="#333">S</text>
                        <text x="55" y="180" text-anchor="end" font-size="14" font-weight="700" fill="#333">E</text>
                        <text x="55" y="90" text-anchor="end" font-size="14" font-weight="700" fill="#333">C</text>

                        <!-- ä¸­å¿ƒç‚¹ -->
                        <circle cx="140" cy="130" r="3" fill="#0066FF" />
                    </svg>
                </div>

                <!-- RIASECå„æ¬¡å…ƒã®è©³ç´°ã‚¹ã‚³ã‚¢ -->
                <div id="riasecBreakdown"
                    style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin: 16px 0; font-size: 13px;">
                    <!-- JSã§å‹•çš„ã«ç”Ÿæˆ -->
                </div>

                <div style="font-size: 11px; color: #888; text-align: center; margin-bottom: 12px;">
                    R:ç¾å®Ÿçš„ I:ç ”ç©¶çš„ A:èŠ¸è¡“çš„ S:ç¤¾ä¼šçš„ E:ä¼æ¥­çš„ C:æ…£ç¿’çš„
                </div>

                <div
                    style="background: white; padding: 12px; border-radius: 8px; font-size: 13px; line-height: 1.6; color: #555;">
                    <strong>RIASEC 3-letter code:</strong> ã‚ãªãŸã®è·æ¥­èˆˆå‘³ã‚’ä¸Šä½3ã¤ã®æ¬¡å…ƒã§è¡¨ç¾ã—ãŸã‚³ãƒ¼ãƒ‰ã§ã™ã€‚æ•°å€¤ãŒé«˜ã„æ¬¡å…ƒã»ã©ã€ãã®èˆˆå‘³ãŒå¼·ã„ã“ã¨ã‚’ç¤ºã—ã¾ã™ã€‚
                </div>
            </div>

            <div class="result-details"
                style="background: linear-gradient(135deg, #fff5f8, #f5fff8); border: 2px solid #ffe0f0;">
                <h3>ğŸ¯ è¨ºæ–­ä¿¡é ¼åº¦</h3>
                <div style="margin: 16px 0;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                        <span style="font-weight: 600; color: var(--dark);">ä¿¡é ¼åº¦ãƒ¬ãƒ™ãƒ«:</span>
                        <span style="font-size: 24px; font-weight: 800; color: var(--primary);"
                            id="confidenceLevel">85%</span>
                    </div>
                    <div
                        style="width: 100%; height: 12px; background: #e8e8e8; border-radius: 100px; overflow: hidden;">
                        <div id="confidenceBar"
                            style="height: 100%; width: 85%; background: #00C896; transition: all 0.5s ease;"></div>
                    </div>
                </div>
                <div
                    style="background: white; padding: 12px; border-radius: 8px; font-size: 13px; line-height: 1.6; color: #555; margin-top: 12px;">
                    <strong>ä¿¡é ¼åº¦ã«ã¤ã„ã¦:</strong> Scheinã®ç†è«–ã§ã¯ã€ã‚­ãƒ£ãƒªã‚¢ãƒ»ã‚¢ãƒ³ã‚«ãƒ¼ã¯å®Ÿå‹™çµŒé¨“ã‚’é€šã˜ã¦æ˜ç¢ºåŒ–ã•ã‚Œã¾ã™ã€‚ã‚ãªãŸã®çµŒé¨“ãƒ¬ãƒ™ãƒ«ã¨å›ç­”ã®ä¸€è²«æ€§ã‹ã‚‰ç®—å‡ºã•ã‚ŒãŸä¿¡é ¼åº¦ã§ã™ã€‚
                </div>
            </div>

            <div class="result-details theoretical-basis">
                <h3>ğŸ“š è¨ºæ–­ã®ç†è«–çš„æ ¹æ‹ </h3>
                <div style="margin-bottom: 12px;">
                    <strong>ã‚­ãƒ£ãƒªã‚¢ãƒ»ã‚¢ãƒ³ã‚«ãƒ¼ï¼ˆScheinï¼‰:</strong>
                    <div id="scheinAnchor" style="color: #666; margin-top: 4px;"></div>
                </div>
                <div style="margin-bottom: 12px;">
                    <strong>è·æ¥­èˆˆå‘³ã‚¿ã‚¤ãƒ—ï¼ˆHollandï¼‰:</strong>
                    <div id="hollandCode" style="color: #666; margin-top: 4px;"></div>
                </div>
                <div
                    style="margin-top: 16px; padding: 16px; background: #f8f9fa; border-radius: 8px; font-size: 14px; line-height: 1.7; color: #555;">
                    <div id="theoreticalExplanation"></div>
                </div>
            </div>

            <div class="cta-section">
                <h3 id="ctaTitle">æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¸</h3>
                <p id="ctaDescription"></p>
                <a class="btn btn-secondary" id="ctaButton" href="#" target="_blank">è©³ã—ãè¦‹ã‚‹</a>
            </div>

            <!-- ã‚·ã‚§ã‚¢ä¿ƒé€²ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆç›®ç«‹ã¤ãƒ‡ã‚¶ã‚¤ãƒ³ï¼‰ -->
            <div
                style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 32px; border-radius: 20px; margin-bottom: 24px; text-align: center; box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);">
                <div style="font-size: 22px; font-weight: 800; color: white; margin-bottom: 8px;">
                    ğŸ‰ çµæœã‚’ã‚·ã‚§ã‚¢ã—ã¦ã¿ã‚ˆã†ï¼
                </div>
                <div style="font-size: 14px; color: rgba(255,255,255,0.9); margin-bottom: 20px;">
                    è¨ºæ–­çµæœã®ç”»åƒã‚’è‡ªå‹•ç”Ÿæˆï¼Xã§ã‚·ã‚§ã‚¢ã—ã¦ä»²é–“ã«åºƒã‚ã‚ˆã†
                </div>
                <div class="share-buttons">
                    <button class="share-btn" onclick="downloadResultImage()"
                        style="background: linear-gradient(135deg, #FF6B6B, #FF8E53); color: white; border: none; font-size: 16px; padding: 14px 32px; font-weight: 700; margin-bottom: 12px; border-radius: 100px; cursor: pointer; box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);">
                        ğŸ“¸ çµæœç”»åƒã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                    </button>
                    <button class="share-btn share-twitter" onclick="shareTwitter()"
                        style="background: #1DA1F2; color: white; border: none; font-size: 16px; padding: 14px 32px; font-weight: 700; border-radius: 100px; cursor: pointer;">
                        ğ• ã§ã‚·ã‚§ã‚¢
                    </button>
                    <button class="share-btn share-line" onclick="shareLine()"
                        style="background: #00B900; color: white; border: none; font-size: 16px; padding: 14px 32px; font-weight: 700; border-radius: 100px; cursor: pointer;">
                        ğŸ“± LINEã§ã‚·ã‚§ã‚¢
                    </button>
                </div>
                <div style="font-size: 12px; color: rgba(255,255,255,0.8); margin-top: 16px;">
                    ğŸ’¡ ã‚·ã‚§ã‚¢ã™ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šå¤šãã®ç¤¾åŠ´å£«ä»²é–“ã¨ã¤ãªãŒã‚Œã¾ã™
                </div>
            </div>

            <button class="btn retry-btn" onclick="location.reload()"
                style="background: white; color: var(--primary); border: 2px solid var(--primary);">ã‚‚ã†ä¸€åº¦è¨ºæ–­ã™ã‚‹</button>
        </div>
    </div>

    <script>
        // æ¡ä»¶åˆ†å²å‹ã®è³ªå•æ§‹é€ 
        const questionFlow = {
            // æœ€åˆã®è³ªå•ï¼ˆåˆ†å²ã®èµ·ç‚¹ï¼‰
            start: {
                id: 'experience',
                question: "ç¤¾åŠ´å£«ã¨ã—ã¦ã®çµŒé¨“å¹´æ•°ã¯ï¼Ÿ",
                options: [
                    { text: "ã¾ã è³‡æ ¼ã‚’æŒã£ã¦ã„ãªã„ï¼ˆå—é¨“ç”Ÿï¼‰", next: 'beginner_path', score: { beginner: 5 } },
                    { text: "è³‡æ ¼å–å¾—ã—ãŸã°ã‹ã‚Šï¼ˆå®Ÿå‹™æœªçµŒé¨“ï¼‰", next: 'newbie_path', score: { beginner: 3, practitioner: 2 } },
                    { text: "å®Ÿå‹™çµŒé¨“1-3å¹´", next: 'practitioner_path', score: { practitioner: 5 } },
                    { text: "å®Ÿå‹™çµŒé¨“3å¹´ä»¥ä¸Š", next: 'expert_path', score: { expert: 5 } }
                ]
            },

            // å—é¨“ç”Ÿå‘ã‘ãƒ‘ã‚¹ï¼ˆ2å•ã«å‰Šæ¸›ï¼‰
            beginner_path: {
                id: 'study_style',
                question: "ç¤¾åŠ´å£«ã‚’ç›®æŒ‡ã—ãŸç†ç”±ã¯ï¼Ÿ",
                options: [
                    { text: "å®‰å®šã—ãŸå°‚é–€è·ã«å°±ããŸã„", next: 'beginner_career', score: { practitioner: 4, beginner: 3 } },
                    { text: "ç‹¬ç«‹é–‹æ¥­ã—ãŸã„", next: 'beginner_career', score: { entrepreneur: 5 } },
                    { text: "å°‚é–€æ€§ã‚’æ´»ã‹ã—ãŸã„", next: 'beginner_career', score: { expert: 4 } },
                    { text: "ä»²é–“ã¨å­¦ã³ãŸã„", next: 'beginner_career', score: { beginner: 5 } }
                ]
            },
            beginner_career: {
                id: 'post_exam_vision',
                question: "åˆæ ¼å¾Œã€ã©ã“ã§åƒããŸã„ï¼Ÿ",
                options: [
                    { text: "ç¤¾åŠ´å£«äº‹å‹™æ‰€", next: 'common_priority', score: { practitioner: 5 } },
                    { text: "ä¼æ¥­ã®äººäº‹éƒ¨", next: 'common_priority', score: { practitioner: 4 } },
                    { text: "ç‹¬ç«‹é–‹æ¥­", next: 'common_priority', score: { entrepreneur: 5 } },
                    { text: "ã¾ã æ±ºã‚ã¦ã„ãªã„", next: 'common_priority', score: { beginner: 4 } }
                ]
            },

            // åˆæ ¼è€…å‘ã‘ãƒ‘ã‚¹
            newbie_path: {
                id: 'job_search',
                question: "å°±è·æ´»å‹•ã®çŠ¶æ³ã¯ï¼Ÿ",
                options: [
                    { text: "ç©æ¥µçš„ã«æ´»å‹•ä¸­", next: 'newbie_interest', score: { practitioner: 4 } },
                    { text: "ã“ã‚Œã‹ã‚‰å§‹ã‚ã‚‹", next: 'newbie_interest', score: { beginner: 3, practitioner: 2 } },
                    { text: "ç‹¬ç«‹ã‚’æ¤œè¨ä¸­", next: 'newbie_interest', score: { entrepreneur: 5 } },
                    { text: "æ–¹å‘æ€§ã‚’æ¨¡ç´¢ä¸­", next: 'newbie_interest', score: { beginner: 4 } }
                ]
            },
            newbie_interest: {
                id: 'business_interest',
                question: "ã©ã®æ¥­å‹™ã«èˆˆå‘³ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
                options: [
                    { text: "1å·ãƒ»2å·æ¥­å‹™ï¼ˆæ‰‹ç¶šããƒ»çµ¦ä¸è¨ˆç®—ï¼‰", next: 'common_priority', score: { practitioner: 4 } },
                    { text: "3å·æ¥­å‹™ï¼ˆåŠ´å‹™ç›¸è«‡ãƒ»ã‚³ãƒ³ã‚µãƒ«ï¼‰", next: 'common_priority', score: { expert: 5 } },
                    { text: "ã©ã¡ã‚‰ã‚‚ãƒãƒ©ãƒ³ã‚¹ã‚ˆã", next: 'common_priority', score: { practitioner: 2, expert: 2 } },
                    { text: "ã¾ã ã‚ˆãã‚ã‹ã‚‰ãªã„", next: 'common_priority', score: { beginner: 4 } }
                ]
            },

            // å®Ÿå‹™è€…å‘ã‘ãƒ‘ã‚¹
            practitioner_path: {
                id: 'current_work',
                question: "ç¾åœ¨ã®ä¸»ãªæ¥­å‹™ã¯ï¼Ÿ",
                options: [
                    { text: "æ‰‹ç¶šããƒ»çµ¦ä¸è¨ˆç®—ä¸­å¿ƒ", next: 'practitioner_satisfaction', score: { practitioner: 5 } },
                    { text: "åŠ´å‹™ç›¸è«‡ã‚‚æ‹…å½“", next: 'practitioner_satisfaction', score: { expert: 4 } },
                    { text: "å¹…åºƒãå¯¾å¿œ", next: 'practitioner_satisfaction', score: { practitioner: 3, expert: 2 } },
                    { text: "ä¼æ¥­å†…ç¤¾åŠ´å£«", next: 'practitioner_satisfaction', score: { practitioner: 4 } }
                ]
            },
            practitioner_satisfaction: {
                id: 'career_satisfaction',
                question: "ç¾åœ¨ã®ä»•äº‹ã«æº€è¶³ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ",
                options: [
                    { text: "æº€è¶³ã—ã¦ã„ã‚‹ï¼ˆã‚¹ã‚­ãƒ«ã‚¢ãƒƒãƒ—ã—ãŸã„ï¼‰", next: 'common_priority', score: { expert: 4 } },
                    { text: "ã¾ã‚æº€è¶³ï¼ˆç¾çŠ¶ç¶­æŒï¼‰", next: 'common_priority', score: { practitioner: 4 } },
                    { text: "è»¢è·ã‚’æ¤œè¨ä¸­", next: 'common_priority', score: { practitioner: 3, entrepreneur: 2 } },
                    { text: "ç‹¬ç«‹ã‚’è¦–é‡ã«å…¥ã‚Œã¦ã„ã‚‹", next: 'common_priority', score: { entrepreneur: 5 } }
                ]
            },

            // ãƒ™ãƒ†ãƒ©ãƒ³å‘ã‘ãƒ‘ã‚¹
            expert_path: {
                id: 'specialization',
                question: "å°‚é–€åˆ†é‡ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
                options: [
                    { text: "ã‚ã‚‹ï¼ˆã•ã‚‰ã«æ·±ã‚ãŸã„ï¼‰", next: 'expert_aspiration', score: { expert: 5 } },
                    { text: "ã‚ã‚‹ï¼ˆåºƒã’ãŸã„ï¼‰", next: 'expert_aspiration', score: { expert: 4, entrepreneur: 1 } },
                    { text: "ã“ã‚Œã‹ã‚‰ä½œã‚ŠãŸã„", next: 'expert_aspiration', score: { expert: 4 } },
                    { text: "å¹…åºƒãå¯¾å¿œã—ã¦ã„ã‚‹", next: 'expert_aspiration', score: { practitioner: 3, entrepreneur: 2 } }
                ]
            },
            expert_aspiration: {
                id: 'future_plan',
                question: "ä»Šå¾Œã®ã‚­ãƒ£ãƒªã‚¢ãƒ—ãƒ©ãƒ³ã¯ï¼Ÿ",
                options: [
                    { text: "å°‚é–€å®¶ã¨ã—ã¦ã•ã‚‰ã«æ·±åŒ–", next: 'common_priority', score: { expert: 5 } },
                    { text: "ç‹¬ç«‹ãƒ»äº‹æ¥­æ‹¡å¤§", next: 'common_priority', score: { entrepreneur: 5 } },
                    { text: "å¾Œé€²ã®è‚²æˆ", next: 'common_priority', score: { expert: 3, practitioner: 2 } },
                    { text: "æ–°ã—ã„åˆ†é‡ã«æŒ‘æˆ¦", next: 'common_priority', score: { expert: 4, entrepreneur: 1 } }
                ]
            },

            // å…¨å“¡å…±é€šã®è³ªå•ï¼ˆ2å•ï¼‰
            common_priority: {
                id: 'career_priority',
                question: "ã‚­ãƒ£ãƒªã‚¢ã§é‡è¦–ã™ã‚‹ã“ã¨ã¯ï¼Ÿ",
                options: [
                    { text: "å°‚é–€æ€§ã‚’é«˜ã‚ãŸã„", next: 'common_ai', score: { expert: 5 } },
                    { text: "å®‰å®šã—ãŸåå…¥ã‚’å¾—ãŸã„", next: 'common_ai', score: { practitioner: 5 } },
                    { text: "å¤§ããç¨¼ããŸã„", next: 'common_ai', score: { entrepreneur: 5 } },
                    { text: "ãƒãƒ©ãƒ³ã‚¹é‡è¦–", next: 'common_ai', score: { practitioner: 3 } }
                ]
            },
            common_ai: {
                id: 'ai_interest',
                question: "AIãƒ»ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ã¸ã®é–¢å¿ƒã¯ï¼Ÿ",
                options: [
                    { text: "ç©æ¥µçš„ã«æ´»ç”¨ã—ãŸã„", next: 'riasec_s1', score: { entrepreneur: 3, expert: 2 } },
                    { text: "å¿…è¦ã«å¿œã˜ã¦ä½¿ã†", next: 'riasec_s1', score: { practitioner: 4 } },
                    { text: "ã‚ã¾ã‚Šèˆˆå‘³ãŒãªã„", next: 'riasec_s1', score: { practitioner: 2 } },
                    { text: "ã¾ã ã‚ã‹ã‚‰ãªã„", next: 'riasec_s1', score: { beginner: 3 } }
                ]
            },

            // ===== RIASECæ¸¬å®šè³ªå•ï¼ˆè¨ˆ18å•ï¼‰ =====

            // Sï¼ˆç¤¾ä¼šçš„ï¼‰æ¸¬å®š - 3å•
            riasec_s1: {
                id: 'riasec_s1',
                question: "ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®æ‚©ã¿ã‚’èã„ã¦è§£æ±ºç­–ã‚’ææ¡ˆã™ã‚‹ã“ã¨ã«å–œã³ã‚’æ„Ÿã˜ã‚‹",
                options: [
                    { text: "éå¸¸ã«å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_s2', riasec: { S: 3 }, weight: 1.5 },
                    { text: "ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_s2', riasec: { S: 2 } },
                    { text: "ã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_s2', riasec: { S: 1 } },
                    { text: "å…¨ãå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_s2', riasec: { S: 0 } }
                ]
            },
            riasec_s2: {
                id: 'riasec_s2',
                question: "äººã‚’åŠ©ã‘ãŸã‚Šã€ã‚µãƒãƒ¼ãƒˆã™ã‚‹ã“ã¨ã«ä¾¡å€¤ã‚’æ„Ÿã˜ã‚‹",
                options: [
                    { text: "éå¸¸ã«å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_s3', riasec: { S: 3 } },
                    { text: "ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_s3', riasec: { S: 2 } },
                    { text: "ã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_s3', riasec: { S: 1 } },
                    { text: "å…¨ãå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_s3', riasec: { S: 0 } }
                ]
            },
            riasec_s3: {
                id: 'riasec_s3',
                question: "ãƒãƒ¼ãƒ ã§å”åŠ›ã—ã¦åƒãã“ã¨ãŒå¥½ãã ",
                options: [
                    { text: "éå¸¸ã«å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_e1', riasec: { S: 3 } },
                    { text: "ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_e1', riasec: { S: 2 } },
                    { text: "ã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_e1', riasec: { S: 1 } },
                    { text: "å…¨ãå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_e1', riasec: { S: 0 } }
                ]
            },

            // Eï¼ˆä¼æ¥­çš„ï¼‰æ¸¬å®š - 3å•
            riasec_e1: {
                id: 'riasec_e1',
                question: "æ–°ã—ã„ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ç²å¾—ã™ã‚‹å–¶æ¥­æ´»å‹•ã«èˆˆå‘³ãŒã‚ã‚‹",
                options: [
                    { text: "éå¸¸ã«å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_e2', riasec: { E: 3 }, weight: 1.3 },
                    { text: "ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_e2', riasec: { E: 2 } },
                    { text: "ã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_e2', riasec: { E: 1 } },
                    { text: "å…¨ãå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_e2', riasec: { E: 0 } }
                ]
            },
            riasec_e2: {
                id: 'riasec_e2',
                question: "ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã‚’ç™ºæ®ã—ã¦ã€äººã‚’å‹•ã‹ã™ã“ã¨ãŒå¥½ãã ",
                options: [
                    { text: "éå¸¸ã«å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_e3', riasec: { E: 3 } },
                    { text: "ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_e3', riasec: { E: 2 } },
                    { text: "ã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_e3', riasec: { E: 1 } },
                    { text: "å…¨ãå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_e3', riasec: { E: 0 } }
                ]
            },
            riasec_e3: {
                id: 'riasec_e3',
                question: "å¤§ããªåç›Šã‚’ä¸Šã’ã‚‹ã“ã¨ã«å¼·ã„å‹•æ©Ÿã¥ã‘ã‚’æ„Ÿã˜ã‚‹",
                options: [
                    { text: "éå¸¸ã«å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_i1', riasec: { E: 3 } },
                    { text: "ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_i1', riasec: { E: 2 } },
                    { text: "ã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_i1', riasec: { E: 1 } },
                    { text: "å…¨ãå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_i1', riasec: { E: 0 } }
                ]
            },

            // Iï¼ˆç ”ç©¶çš„ï¼‰æ¸¬å®š - 3å•
            riasec_i1: {
                id: 'riasec_i1',
                question: "è¤‡é›‘ãªæ³•å¾‹å•é¡Œã‚’åˆ†æãƒ»ç ”ç©¶ã™ã‚‹ã“ã¨ãŒå¥½ãã ",
                options: [
                    { text: "éå¸¸ã«å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_i2', riasec: { I: 3 }, weight: 1.3 },
                    { text: "ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_i2', riasec: { I: 2 } },
                    { text: "ã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_i2', riasec: { I: 1 } },
                    { text: "å…¨ãå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_i2', riasec: { I: 0 } }
                ]
            },
            riasec_i2: {
                id: 'riasec_i2',
                question: "ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã¦è«–ç†çš„ãªçµè«–ã‚’å°ãã“ã¨ãŒå¾—æ„ã ",
                options: [
                    { text: "éå¸¸ã«å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_i3', riasec: { I: 3 } },
                    { text: "ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_i3', riasec: { I: 2 } },
                    { text: "ã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_i3', riasec: { I: 1 } },
                    { text: "å…¨ãå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_i3', riasec: { I: 0 } }
                ]
            },
            riasec_i3: {
                id: 'riasec_i3',
                question: "æ–°ã—ã„çŸ¥è­˜ã‚’å­¦ã³ç¶šã‘ã‚‹ã“ã¨ã«å–œã³ã‚’æ„Ÿã˜ã‚‹",
                options: [
                    { text: "éå¸¸ã«å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_c1', riasec: { I: 3 } },
                    { text: "ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_c1', riasec: { I: 2 } },
                    { text: "ã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_c1', riasec: { I: 1 } },
                    { text: "å…¨ãå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_c1', riasec: { I: 0 } }
                ]
            },

            // Cï¼ˆæ…£ç¿’çš„ï¼‰æ¸¬å®š - 3å•
            riasec_c1: {
                id: 'riasec_c1',
                question: "ãƒ«ãƒ¼ãƒ«ã‚„æ‰‹ç¶šãã«å¾“ã£ã¦æ­£ç¢ºã«æ¥­å‹™ã‚’é€²ã‚ã‚‹ã“ã¨ãŒå¾—æ„ã ",
                options: [
                    { text: "éå¸¸ã«å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_c2', riasec: { C: 3 }, weight: 1.2 },
                    { text: "ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_c2', riasec: { C: 2 } },
                    { text: "ã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_c2', riasec: { C: 1 } },
                    { text: "å…¨ãå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_c2', riasec: { C: 0 } }
                ]
            },
            riasec_c2: {
                id: 'riasec_c2',
                question: "ãƒ‡ãƒ¼ã‚¿ã‚’æ•´ç†ã—ã€ä½“ç³»çš„ã«ç®¡ç†ã™ã‚‹ã“ã¨ãŒå¥½ãã ",
                options: [
                    { text: "éå¸¸ã«å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_c3', riasec: { C: 3 } },
                    { text: "ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_c3', riasec: { C: 2 } },
                    { text: "ã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_c3', riasec: { C: 1 } },
                    { text: "å…¨ãå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_c3', riasec: { C: 0 } }
                ]
            },
            riasec_c3: {
                id: 'riasec_c3',
                question: "ç´°éƒ¨ã¾ã§æ³¨æ„ã‚’æ‰•ã„ã€ãƒŸã‚¹ã®ãªã„ä»•äº‹ã‚’ã™ã‚‹ã“ã¨ã‚’é‡è¦–ã™ã‚‹",
                options: [
                    { text: "éå¸¸ã«å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_r1', riasec: { C: 3 } },
                    { text: "ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_r1', riasec: { C: 2 } },
                    { text: "ã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_r1', riasec: { C: 1 } },
                    { text: "å…¨ãå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_r1', riasec: { C: 0 } }
                ]
            },

            // Rï¼ˆç¾å®Ÿçš„ï¼‰æ¸¬å®š - 3å•
            riasec_r1: {
                id: 'riasec_r1',
                question: "å®Ÿéš›ã«æ‰‹ã‚’å‹•ã‹ã—ã¦å…·ä½“çš„ãªæˆæœç‰©ã‚’ä½œã‚‹ã“ã¨ãŒå¥½ãã ",
                options: [
                    { text: "éå¸¸ã«å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_r2', riasec: { R: 3 } },
                    { text: "ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_r2', riasec: { R: 2 } },
                    { text: "ã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_r2', riasec: { R: 1 } },
                    { text: "å…¨ãå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_r2', riasec: { R: 0 } }
                ]
            },
            riasec_r2: {
                id: 'riasec_r2',
                question: "æ©Ÿæ¢°ã‚„ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦åŠ¹ç‡çš„ã«ä½œæ¥­ã™ã‚‹ã“ã¨ã«èˆˆå‘³ãŒã‚ã‚‹",
                options: [
                    { text: "éå¸¸ã«å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_r3', riasec: { R: 3 } },
                    { text: "ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_r3', riasec: { R: 2 } },
                    { text: "ã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_r3', riasec: { R: 1 } },
                    { text: "å…¨ãå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_r3', riasec: { R: 0 } }
                ]
            },
            riasec_r3: {
                id: 'riasec_r3',
                question: "æ±ºã‚ã‚‰ã‚ŒãŸæ‰‹é †ã§ç¢ºå®Ÿã«æˆæœã‚’å‡ºã™ã“ã¨ã‚’å¥½ã‚€",
                options: [
                    { text: "éå¸¸ã«å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_a1', riasec: { R: 3 } },
                    { text: "ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_a1', riasec: { R: 2 } },
                    { text: "ã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_a1', riasec: { R: 1 } },
                    { text: "å…¨ãå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_a1', riasec: { R: 0 } }
                ]
            },

            // Aï¼ˆèŠ¸è¡“çš„ï¼‰æ¸¬å®š - 3å•
            riasec_a1: {
                id: 'riasec_a1',
                question: "å‰µé€ çš„ãƒ»ç‹¬å‰µçš„ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§å•é¡Œè§£æ±ºã™ã‚‹ã“ã¨ãŒå¥½ãã ",
                options: [
                    { text: "éå¸¸ã«å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_a2', riasec: { A: 3 } },
                    { text: "ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_a2', riasec: { A: 2 } },
                    { text: "ã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_a2', riasec: { A: 1 } },
                    { text: "å…¨ãå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_a2', riasec: { A: 0 } }
                ]
            },
            riasec_a2: {
                id: 'riasec_a2',
                question: "æ–°ã—ã„ã‚¢ã‚¤ãƒ‡ã‚¢ã‚„è¡¨ç¾æ–¹æ³•ã‚’è€ƒãˆã‚‹ã“ã¨ãŒå¥½ãã ",
                options: [
                    { text: "éå¸¸ã«å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_a3', riasec: { A: 3 } },
                    { text: "ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹", next: 'riasec_a3', riasec: { A: 2 } },
                    { text: "ã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_a3', riasec: { A: 1 } },
                    { text: "å…¨ãå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'riasec_a3', riasec: { A: 0 } }
                ]
            },
            riasec_a3: {
                id: 'riasec_a3',
                question: "å¾“æ¥ã®ã‚„ã‚Šæ–¹ã«ã¨ã‚‰ã‚ã‚Œãšã€æŸ”è»Ÿã«ç™ºæƒ³ã™ã‚‹ã“ã¨ãŒå¾—æ„ã ",
                options: [
                    { text: "éå¸¸ã«å½“ã¦ã¯ã¾ã‚‹", next: 'worklife_balance', riasec: { A: 3 } },
                    { text: "ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹", next: 'worklife_balance', riasec: { A: 2 } },
                    { text: "ã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'worklife_balance', riasec: { A: 1 } },
                    { text: "å…¨ãå½“ã¦ã¯ã¾ã‚‰ãªã„", next: 'worklife_balance', riasec: { A: 0 } }
                ]
            },

            // ãƒ¯ãƒ¼ã‚¯ãƒ©ã‚¤ãƒ•ãƒãƒ©ãƒ³ã‚¹ï¼ˆSuperã®ç†è«–ï¼‰
            worklife_balance: {
                id: 'worklife',
                question: "äººç”Ÿã«ãŠã„ã¦ä»•äº‹ã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã®ãƒãƒ©ãƒ³ã‚¹ã‚’ã©ã†è€ƒãˆã¾ã™ã‹ï¼Ÿ",
                options: [
                    { text: "ä»•äº‹æœ€å„ªå…ˆã§æˆæœã‚’å‡ºã—ãŸã„", next: 'end', score: { entrepreneur: 3, expert: 2 }, weight: 1.2 },
                    { text: "ä»•äº‹ã‚‚ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚‚ãƒãƒ©ãƒ³ã‚¹é‡è¦–", next: 'end', score: { practitioner: 3 } },
                    { text: "ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚’å……å®Ÿã•ã›ãŸã„", next: 'end', score: { practitioner: 2 } },
                    { text: "ã¾ã åˆ†ã‹ã‚‰ãªã„", next: 'end', score: { beginner: 2 } }
                ]
            }
        };

        const resultTypes = {
            beginner: {
                icon: "ğŸŒ±",
                type: "æˆé•·å¿—å‘ã‚¿ã‚¤ãƒ—",
                catchPhrase: "ã‚³ãƒ„ã‚³ãƒ„åŠªåŠ›å‹ã®å¤§å™¨æ™©æˆã‚¿ã‚¤ãƒ—ï¼",
                badge: "ğŸ“š ã‚¹ãƒ†ãƒ‡ã‚£ãƒ»ã‚°ãƒ­ãƒ¯ãƒ¼",
                rarity: 35,
                rarityLevel: "ã‚ˆãã„ã‚‹",
                rarityColor: "#4CAF50",
                description: "ã‚ãªãŸã¯ç¤¾åŠ´å£«ã¨ã—ã¦ã®ã‚­ãƒ£ãƒªã‚¢ã‚’ã“ã‚Œã‹ã‚‰ç¯‰ã„ã¦ã„ãæ®µéšã€‚ä»²é–“ã¨å…±ã«å­¦ã³ã€ç¢ºå®Ÿã«æˆé•·ã—ã¦ã„ãã“ã¨ãŒå¤§åˆ‡ã§ã™ã€‚",
                traits: [
                    "å­¦ç¿’æ„æ¬²ãŒé«˜ã„",
                    "åŸºç¤ã‚’ã—ã£ã‹ã‚Šèº«ã«ã¤ã‘ãŸã„",
                    "ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã§ã®å­¦ã³ã‚’é‡è¦–",
                    "åˆæ ¼å¾Œã®ã‚­ãƒ£ãƒªã‚¢ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æããŸã„"
                ],
                viralMessage: "å …å®Ÿæ´¾ã®ã‚ãªãŸã€‚ä¸€æ­©ãšã¤ç¢ºå®Ÿã«æˆé•·ã™ã‚‹å§¿å‹¢ãŒæœ€å¼·ã®æ­¦å™¨âœ¨",
                theoreticalBasis: {
                    schein: "å°‚é–€ãƒ»è·èƒ½åˆ¥èƒ½åŠ› (TF) + ä¿éšœãƒ»å®‰å®š (SE)",
                    holland: "Sï¼ˆç¤¾ä¼šçš„ï¼‰ + Cï¼ˆæ…£ç¿’çš„ï¼‰",
                    explanation: "Edgar Scheinã®ã‚­ãƒ£ãƒªã‚¢ãƒ»ã‚¢ãƒ³ã‚«ãƒ¼ç†è«–ã«ã‚ˆã‚Œã°ã€ã‚ãªãŸã¯å°‚é–€æ€§ã®åŸºç¤ã‚’ç¯‰ããªãŒã‚‰ã€å®‰å®šã—ãŸã‚­ãƒ£ãƒªã‚¢æ§‹ç¯‰ã‚’é‡è¦–ã™ã‚‹ã‚¿ã‚¤ãƒ—ã§ã™ã€‚John Hollandã®RIASECç†è«–ã§ã¯ã€äººã‚’æ”¯æ´ã™ã‚‹ç¤¾ä¼šçš„å¿—å‘ã¨ã€ä½“ç³»çš„ãªå­¦ç¿’ã‚’å¥½ã‚€æ…£ç¿’çš„å¿—å‘ã®çµ„ã¿åˆã‚ã›ãŒç‰¹å¾´çš„ã§ã™ã€‚"
                },
                ctaTitle: "ã‚·ãƒ£ãƒ­ã‚¹ã‚¿ã§ä»²é–“ã¨å…±ã«åˆæ ¼ã‚’ç›®æŒ‡ãã†",
                ctaDescription: "ç¤¾åŠ´å£«è©¦é¨“å¯¾ç­–ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã€Œã‚·ãƒ£ãƒ­ã‚¹ã‚¿ã€ã§ã€å—é¨“ä»²é–“ã¨åˆ‡ç£‹ç¢ç£¨ã—ãªãŒã‚‰åˆæ ¼ã‚’ç›®æŒ‡ã—ã¾ã›ã‚“ã‹ï¼Ÿ",
                ctaButton: "ã‚·ãƒ£ãƒ­ã‚¹ã‚¿ã‚’è¦‹ã‚‹",
                ctaLink: "https://gakko.shikumisr.jp/studyingsr"
            },
            practitioner: {
                icon: "ğŸ’¼",
                type: "å®Ÿå‹™é‡è¦–ã‚¿ã‚¤ãƒ—",
                catchPhrase: "ç¾å ´ã§ä¿¡é ¼ã•ã‚Œã‚‹å®Ÿå‹™ã®ãƒ—ãƒ­ï¼",
                badge: "ğŸ›¡ï¸ ãƒªãƒ©ã‚¤ã‚¢ãƒ–ãƒ«ãƒ»ãƒã‚¹ã‚¿ãƒ¼",
                rarity: 40,
                rarityLevel: "ãµã¤ã†",
                rarityColor: "#2196F3",
                description: "ã‚ãªãŸã¯å®Ÿå‹™çµŒé¨“ã‚’ç©ã¿ã€å®‰å®šã—ãŸã‚­ãƒ£ãƒªã‚¢ã‚’ç¯‰ããŸã„ã‚¿ã‚¤ãƒ—ã€‚åŸºç¤å®Ÿå‹™ã‚’ç¢ºå®Ÿã«ãƒã‚¹ã‚¿ãƒ¼ã—ã€ä¿¡é ¼ã•ã‚Œã‚‹ç¤¾åŠ´å£«ã‚’ç›®æŒ‡ã—ã¾ã—ã‚‡ã†ã€‚",
                traits: [
                    "å®Ÿå‹™ã‚¹ã‚­ãƒ«ã®å‘ä¸Šã‚’é‡è¦–",
                    "å®‰å®šã—ãŸã‚­ãƒ£ãƒªã‚¢ã‚’å¿—å‘",
                    "æ‰‹ç¶šããƒ»çµ¦ä¸è¨ˆç®—ã«å¼·ããªã‚ŠãŸã„",
                    "äº‹å‹™æ‰€å°±è·ã‚„ä¼æ¥­å†…ç¤¾åŠ´å£«ã‚’æ¤œè¨"
                ],
                viralMessage: "å®‰å®šå¿—å‘ã®ã‚ãªãŸã€‚å®Ÿå‹™åŠ›ã§å‹è² ã™ã‚‹å …å®Ÿæ´¾ã¯ã€ã©ã‚“ãªæ™‚ä»£ã§ã‚‚å¼·ã„ğŸ”¥",
                theoreticalBasis: {
                    schein: "å°‚é–€ãƒ»è·èƒ½åˆ¥èƒ½åŠ› (TF) + ä¿éšœãƒ»å®‰å®š (SE)",
                    holland: "Cï¼ˆæ…£ç¿’çš„ï¼‰ + Sï¼ˆç¤¾ä¼šçš„ï¼‰",
                    explanation: "Scheinã®ç†è«–ã§ã¯ã€ç‰¹å®šåˆ†é‡ã®å°‚é–€æ€§ã‚’æ·±ã‚ãªãŒã‚‰ã€çµ„ç¹”å†…ã§ã®å®‰å®šã‚’é‡è¦–ã™ã‚‹ã‚¿ã‚¤ãƒ—ã«åˆ†é¡ã•ã‚Œã¾ã™ã€‚Hollandã®ç†è«–ã§ã¯ã€è¦å‰‡çš„ã§ä½“ç³»çš„ãªæ¥­å‹™ã‚’å¥½ã¿ã€äººã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ã“ã¨ã«å–œã³ã‚’æ„Ÿã˜ã‚‹æ€§è³ªãŒé¡•è‘—ã§ã™ã€‚ä¼æ¥­å†…ç¤¾åŠ´å£«ã‚„äº‹å‹™æ‰€å‹¤å‹™ã«é©æ€§ãŒã‚ã‚Šã¾ã™ã€‚"
                },
                ctaTitle: "ç¤¾åŠ´å£«Labã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã§å®Ÿå‹™ã‚’å­¦ã¼ã†",
                ctaDescription: "ç„¡æ–™ã§å‚åŠ ã§ãã‚‹ç¤¾åŠ´å£«Labã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã§ã€å®Ÿå‹™ã®åŸºç¤ã‹ã‚‰å­¦ã³ã€å°±è·ãƒ»è»¢è·ã®ã‚µãƒãƒ¼ãƒˆã‚‚å—ã‘ã‚‰ã‚Œã¾ã™ã€‚",
                ctaButton: "ç¤¾åŠ´å£«Labã‚’è¦‹ã‚‹",
                ctaLink: "https://gakko.shikumisr.jp/srlab_community"
            },
            expert: {
                icon: "âš–ï¸",
                type: "å°‚é–€ç‰¹åŒ–ã‚¿ã‚¤ãƒ—",
                catchPhrase: "AIæ™‚ä»£ã‚’ç”ŸãæŠœãã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆï¼",
                badge: "ğŸ‘‘ ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆãƒ»ã‚¨ãƒªãƒ¼ãƒˆ",
                rarity: 15,
                rarityLevel: "ãƒ¬ã‚¢",
                rarityColor: "#9C27B0",
                description: "ã‚ãªãŸã¯é«˜åº¦ãªå°‚é–€æ€§ã‚’è¿½æ±‚ã™ã‚‹ã‚¿ã‚¤ãƒ—ã€‚æ³•å¾‹ç›¸è«‡ã‚„åŠ´å‹™ãƒˆãƒ©ãƒ–ãƒ«å¯¾å¿œãªã©ã€AIæ™‚ä»£ã§ã‚‚ç”Ÿãæ®‹ã‚‹å°‚é–€å®¶ã‚’ç›®æŒ‡ã—ã¾ã—ã‚‡ã†ã€‚",
                traits: [
                    "3å·æ¥­å‹™ï¼ˆåŠ´å‹™ç›¸è«‡ï¼‰ã«èˆˆå‘³",
                    "æ³•å¾‹çš„ãªå°‚é–€æ€§ã‚’è¿½æ±‚",
                    "ç‰¹å®šç¤¾åŠ´å£«ã‚’è¦–é‡ã«å…¥ã‚Œã¦ã„ã‚‹",
                    "AIã«ä»£æ›¿ã•ã‚Œãªã„ä¾¡å€¤ã‚’æä¾›ã—ãŸã„"
                ],
                viralMessage: "çŸ¥çš„å¥½å¥‡å¿ƒã®å¡Šï¼ã‚ãªãŸã®ã‚ˆã†ãªå°‚é–€å®¶ã“ãã€ã“ã‚Œã‹ã‚‰ã®æ™‚ä»£ã«å¿…è¦ã¨ã•ã‚Œã‚‹äººæğŸ¯",
                theoreticalBasis: {
                    schein: "å°‚é–€ãƒ»è·èƒ½åˆ¥èƒ½åŠ› (TF) + ç´”ç²‹ãªæŒ‘æˆ¦ (CH)",
                    holland: "Iï¼ˆç ”ç©¶çš„ï¼‰ + Sï¼ˆç¤¾ä¼šçš„ï¼‰",
                    explanation: "Scheinã®ç†è«–ã«ãŠã‘ã‚‹ã€Œç´”ç²‹ãªæŒ‘æˆ¦ã€å¿—å‘ãŒå¼·ãã€å›°é›£ãªå•é¡Œè§£æ±ºã«çŸ¥çš„èˆˆå¥®ã‚’è¦šãˆã‚‹ã‚¿ã‚¤ãƒ—ã§ã™ã€‚Hollandã®ç†è«–ã§ã¯ã€åˆ†æçš„æ€è€ƒã‚’é§†ä½¿ã—ã¦è¤‡é›‘ãªåŠ´å‹™å•é¡Œã‚’è§£æ±ºã™ã‚‹ç ”ç©¶çš„æ€§è³ªã¨ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’æ”¯æ´ã™ã‚‹ç¤¾ä¼šçš„æ€§è³ªã®ä¸¡ç«‹ãŒç‰¹å¾´ã§ã™ã€‚ç‰¹å®šç¤¾åŠ´å£«ã‚„åŠ´å‹™ã‚³ãƒ³ã‚µãƒ«ã‚¿ãƒ³ãƒˆã¨ã—ã¦æ´»èºã§ãã¾ã™ã€‚"
                },
                ctaTitle: "ãƒªãƒ¼ã‚¬ãƒ«ãƒ©ãƒœã§å°‚é–€æ€§ã‚’æ¥µã‚ã‚ˆã†",
                ctaDescription: "é«˜åº¦ãªåŠ´å‹™ç›¸è«‡å¯¾å¿œã‚¹ã‚­ãƒ«ã‚’å­¦ã¹ã‚‹ã€Œãƒªãƒ¼ã‚¬ãƒ«ãƒ©ãƒœã€ã§ã€æ³•å¾‹å®¶ã¨ã—ã¦ã®ç¤¾åŠ´å£«ã‚’ç›®æŒ‡ã—ã¾ã›ã‚“ã‹ï¼Ÿ",
                ctaButton: "ãƒªãƒ¼ã‚¬ãƒ«ãƒ©ãƒœã‚’è¦‹ã‚‹",
                ctaLink: "https://gakko.shikumisr.jp/legal_lab"
            },
            entrepreneur: {
                icon: "ğŸš€",
                type: "ç‹¬ç«‹å¿—å‘ã‚¿ã‚¤ãƒ—",
                catchPhrase: "æ¬¡ä¸–ä»£ã‚’å‰µã‚‹èµ·æ¥­å®¶ãƒã‚¤ãƒ³ãƒ‰ã®æŒã¡ä¸»ï¼",
                badge: "ğŸ’ ãƒ“ã‚¸ãƒ§ãƒŠãƒªãƒ¼ãƒ»ãƒªãƒ¼ãƒ€ãƒ¼",
                rarity: 10,
                rarityLevel: "æ¿€ãƒ¬ã‚¢",
                rarityColor: "#FF6B6B",
                description: "ã‚ãªãŸã¯ç‹¬ç«‹é–‹æ¥­ã‚’è¦–é‡ã«å…¥ã‚ŒãŸé‡å¿ƒå®¶ã‚¿ã‚¤ãƒ—ã€‚é¡§å®¢ç²å¾—ã€çµŒå–¶ã‚¹ã‚­ãƒ«ã€ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãªã©ã€ç‹¬ç«‹ã«å¿…è¦ãªåŠ›ã‚’èº«ã«ã¤ã‘ã¾ã—ã‚‡ã†ã€‚",
                traits: [
                    "ç‹¬ç«‹é–‹æ¥­ã‚’ç›®æŒ‡ã—ã¦ã„ã‚‹",
                    "å¤§ããç¨¼ããŸã„é‡å¿ƒãŒã‚ã‚‹",
                    "å–¶æ¥­ãƒ»ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ã«èˆˆå‘³",
                    "è‡ªåˆ†ã®ãƒ–ãƒ©ãƒ³ãƒ‰ã‚’ç¢ºç«‹ã—ãŸã„"
                ],
                viralMessage: "é‡å¿ƒã¨è¡Œå‹•åŠ›ã‚’å…¼ã­å‚™ãˆãŸç¨€å°‘äººæï¼ã‚ãªãŸã¯å…¨ä½“ã®ã‚ãšã‹10%ğŸ’«",
                theoreticalBasis: {
                    schein: "èµ·æ¥­å®¶çš„å‰µé€ æ€§ (EC) + è‡ªå¾‹ãƒ»ç‹¬ç«‹ (AU)",
                    holland: "Eï¼ˆä¼æ¥­çš„ï¼‰ + Sï¼ˆç¤¾ä¼šçš„ï¼‰",
                    explanation: "Scheinã®ç†è«–ã§ã¯ã€è‡ªã‚‰äº‹æ¥­ã‚’å‰µé€ ã—ã€è‡ªå¾‹çš„ã«åƒãã“ã¨ã«æœ€å¤§ã®ä¾¡å€¤ã‚’ç½®ãã‚¿ã‚¤ãƒ—ã§ã™ã€‚Hollandã®ç†è«–ã«ãŠã‘ã‚‹ä¼æ¥­çš„æ€§è³ªï¼ˆãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã€å–¶æ¥­åŠ›ã€çµŒå–¶ã‚»ãƒ³ã‚¹ï¼‰ã¨ç¤¾ä¼šçš„æ€§è³ªï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆæ”¯æ´ï¼‰ã®çµ„ã¿åˆã‚ã›ã¯ã€ç‹¬ç«‹é–‹æ¥­ç¤¾åŠ´å£«ã«æœ€é©ãªç‰¹æ€§ã§ã™ã€‚"
                },
                ctaTitle: "ç¤¾åŠ´å£«Labã§ç‹¬ç«‹æº–å‚™ã‚’å§‹ã‚ã‚ˆã†",
                ctaDescription: "ç‹¬ç«‹é–‹æ¥­ã‚’ç›®æŒ‡ã™ä»²é–“ã¨ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ§‹ç¯‰ã€æ¡ˆä»¶ç´¹ä»‹ã€ã‚­ãƒ£ãƒªã‚¢ç›¸è«‡ãªã©ã€ç‹¬ç«‹æº–å‚™ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚",
                ctaButton: "ç¤¾åŠ´å£«Labã‚’è¦‹ã‚‹",
                ctaLink: "https://gakko.shikumisr.jp/srlab_community"
            }
        };

        let currentQuestionKey = 'start';
        let questionCount = 0;
        let totalQuestions = 24; // å›ºå®šï¼šã©ã®ãƒ‘ã‚¹ã§ã‚‚24å•
        let scores = { beginner: 0, practitioner: 0, expert: 0, entrepreneur: 0 };
        let riasecScores = { R: 0, I: 0, A: 0, S: 0, E: 0, C: 0 };
        let userPath = [];
        let userAnswers = {}; // å„è³ªå•ã®å›ç­”å†…å®¹ã‚’è¨˜éŒ²
        let experienceLevel = ''; // ä¿¡é ¼åº¦è¨ˆç®—ç”¨
        let userNickname = ''; // ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ 
        let userProfileImage = ''; // Xã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒURL
        let twitterUsername = ''; // Xã‚¢ã‚«ã‚¦ãƒ³ãƒˆå
        let isProcessing = false; // å‡¦ç†ä¸­ãƒ•ãƒ©ã‚°ï¼ˆé‡è¤‡ã‚¯ãƒªãƒƒã‚¯é˜²æ­¢ï¼‰

        // ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã®ãƒ™ãƒ¼ã‚¹URLï¼ˆç’°å¢ƒã«å¿œã˜ã¦å¤‰æ›´ï¼‰
        const API_BASE_URL = ''; // ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãªã—ã§å‹•ä½œ
        // ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’è¿½åŠ ã™ã‚‹å ´åˆã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®š:
        // const API_BASE_URL = 'https://your-backend.render.com';

        // Google Apps Script Web Appã®URLï¼ˆã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆé€£æºç”¨ï¼‰
        // ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å¾Œã€ã“ã“ã«ãƒ‡ãƒ—ãƒ­ã‚¤URLã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„
        const GOOGLE_SHEETS_URL = 'https://script.google.com/macros/s/AKfycbzp9Pv3wvntkHWiZ9fNhMUVKMZQMt_2PjuWpkTb2zoqOg_J9Kw6Uo49jhVs3xdxRJg7xA/exec';
        // ä¾‹: 'https://script.google.com/macros/s/AKfycby.../exec'

        function startQuiz() {
            // å…¥åŠ›å€¤ã‚’ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã¨ã—ã¦ä½¿ç”¨
            const input = document.getElementById('twitterUsernameInput').value.trim();
            if (input) {
                userNickname = input;
            }

            // ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆ
            questionCount = 0;
            totalQuestions = 24; // å¿…ãš24å•
            scores = { beginner: 0, practitioner: 0, expert: 0, entrepreneur: 0 };
            riasecScores = { R: 0, I: 0, A: 0, S: 0, E: 0, C: 0 };
            userPath = [];
            userAnswers = {};

            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('progressContainer').classList.remove('hidden');
            document.getElementById('totalQuestions').textContent = '24';
            document.getElementById('currentQuestion').textContent = '0';
            document.getElementById('progressFill').style.width = '0%';
            showQuestion('start');
        }

        function showQuestion(questionKey) {
            if (questionKey === 'end') {
                showResult();
                return;
            }

            questionCount++;
            currentQuestionKey = questionKey;
            userPath.push(questionKey);

            const questionData = questionFlow[questionKey];
            const container = document.getElementById('questionContainer');
            container.innerHTML = '';

            const questionDiv = document.createElement('div');
            questionDiv.className = 'question-screen active';

            questionDiv.innerHTML = `
                <div class="question-title">${questionData.question}</div>
                <div class="options">
                    ${questionData.options.map((option, i) => `
                        <div class="option" onclick="selectOption('${questionKey}', ${i})">
                            ${option.text}
                        </div>
                    `).join('')}
                </div>
            `;

            container.appendChild(questionDiv);
            updateProgress();
        }

        function selectOption(questionKey, optionIndex) {
            // å‡¦ç†ä¸­ãªã‚‰ç„¡è¦–ï¼ˆé‡è¤‡ã‚¯ãƒªãƒƒã‚¯é˜²æ­¢ï¼‰
            if (isProcessing) {
                return;
            }
            isProcessing = true;

            const questionData = questionFlow[questionKey];
            const option = questionData.options[optionIndex];

            // å›ç­”ã‚’è¨˜éŒ²
            userAnswers[questionKey] = {
                question: questionData.question,
                answer: option.text,
                questionNumber: questionCount
            };

            // é‡ã¿ä»˜ã‘ã®å–å¾—ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ1.0ï¼‰
            const weight = option.weight || 1.0;

            // ã‚­ãƒ£ãƒªã‚¢ã‚¿ã‚¤ãƒ—ã‚¹ã‚³ã‚¢ã‚’åŠ ç®—ï¼ˆé‡ã¿ä»˜ã‘é©ç”¨ï¼‰
            if (option.score) {
                Object.keys(option.score).forEach(type => {
                    scores[type] += option.score[type] * weight;
                });
            }

            // RIASECã‚¹ã‚³ã‚¢ã‚’åŠ ç®—ï¼ˆé‡ã¿ä»˜ã‘é©ç”¨ï¼‰
            if (option.riasec) {
                Object.keys(option.riasec).forEach(dimension => {
                    riasecScores[dimension] += option.riasec[dimension] * weight;
                });
            }

            // çµŒé¨“ãƒ¬ãƒ™ãƒ«ã®è¨˜éŒ²ï¼ˆæœ€åˆã®è³ªå•ã§ï¼‰
            if (questionKey === 'start') {
                experienceLevel = option.text;
            }

            // Visual feedback
            const options = document.querySelectorAll('.option');
            options[optionIndex].classList.add('selected');

            setTimeout(() => {
                isProcessing = false; // æ¬¡ã®è³ªå•ã«ç§»ã‚‹å‰ã«ãƒ•ãƒ©ã‚°ã‚’ãƒªã‚»ãƒƒãƒˆ
                showQuestion(option.next);
            }, 300);
        }

        function updateProgress() {
            const progress = (questionCount / totalQuestions) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = questionCount;
            document.getElementById('totalQuestions').textContent = '24';
        }

        function showResult() {
            // Find highest score
            let maxScore = 0;
            let resultType = 'beginner';

            Object.keys(scores).forEach(type => {
                if (scores[type] > maxScore) {
                    maxScore = scores[type];
                    resultType = type;
                }
            });

            let result = resultTypes[resultType];

            // store for later use
            window.currentResultKey = resultType;

            // å—é¨“ç”Ÿã®å ´åˆã®ã¿ã€ã‚·ãƒ£ãƒ­ã‚¹ã‚¿ä¸€æŠã«ä¸Šæ›¸ã
            if (experienceLevel === 'ã¾ã è³‡æ ¼ã‚’æŒã£ã¦ã„ãªã„ï¼ˆå—é¨“ç”Ÿï¼‰') {
                result = {
                    ...result,
                    ctaTitle: "ã‚·ãƒ£ãƒ­ã‚¹ã‚¿ã§ä»²é–“ã¨å…±ã«åˆæ ¼ã‚’ç›®æŒ‡ãã†",
                    ctaDescription: "ç¤¾åŠ´å£«è©¦é¨“å¯¾ç­–ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã€Œã‚·ãƒ£ãƒ­ã‚¹ã‚¿ã€ã§ã€å—é¨“ä»²é–“ã¨åˆ‡ç£‹ç¢ç£¨ã—ãªãŒã‚‰åˆæ ¼ã‚’ç›®æŒ‡ã—ã¾ã›ã‚“ã‹ï¼Ÿ",
                    ctaButton: "ã‚·ãƒ£ãƒ­ã‚¹ã‚¿ã‚’è¦‹ã‚‹",
                    ctaLink: "https://gakko.shikumisr.jp/studyingsr"
                };
            }

            // === RIASEC 3-letter code calculation ===
            const riasecArray = Object.entries(riasecScores)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 3);
            const riasecCode = riasecArray.map(entry => entry[0]).join('-');
            const riasecDetails = riasecArray.map(entry => `${entry[0]}(${entry[1]}ç‚¹)`).join('ã€€');

            // === è¨ºæ–­ä¿¡é ¼åº¦ã®è¨ˆç®— ===
            let confidence = 0;
            if (experienceLevel.includes('3å¹´ä»¥ä¸Š')) {
                confidence = 90;
            } else if (experienceLevel.includes('1-3å¹´')) {
                confidence = 80;
            } else if (experienceLevel.includes('å–å¾—ã—ãŸã°ã‹ã‚Š')) {
                confidence = 70;
            } else {
                confidence = 60;
            }

            // ã‚¹ã‚³ã‚¢ã®åˆ†æ•£åº¦ã‚’è€ƒæ…®ï¼ˆä¸Šä½ã‚¹ã‚³ã‚¢ã¨2ä½ã‚¹ã‚³ã‚¢ã®å·®ãŒå¤§ãã„ã»ã©ä¿¡é ¼åº¦ãŒé«˜ã„ï¼‰
            const sortedScores = Object.values(scores).sort((a, b) => b - a);
            if (sortedScores[0] - sortedScores[1] > 10) {
                confidence += 5;
            }

            // === æˆ¦é—˜åŠ›ã®è¨ˆç®— ===
            const combatPowerData = calculateCombatPower(riasecScores, resultType, experienceLevel);
            const combatPower = combatPowerData.power;
            const rank = combatPowerData.rank;

            // Hide question container and progress
            document.getElementById('questionContainer').innerHTML = '';
            document.getElementById('progressContainer').classList.add('hidden');

            // Show result
            document.getElementById('resultIcon').textContent = result.icon;
            document.getElementById('resultType').textContent = result.type;
            document.getElementById('resultDescription').textContent = result.description;

            // Update Combat Power Display
            document.getElementById('rankBg').textContent = rank;
            document.getElementById('rankDisplay').textContent = `RANK ${rank} - ${combatPowerData.rankText}`;
            document.getElementById('rankDisplay').className = `rank-display ${combatPowerData.rankClass}`;

            // Animate Combat Power
            setTimeout(() => {
                animateValue("combatPowerValue", 0, combatPower, 2000);
            }, 500);

            // Xã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±è¡¨ç¤º
            const nicknameDisplayEl = document.getElementById('nicknameDisplay');
            if (userNickname || userProfileImage) {
                let displayHTML = '';

                if (userProfileImage) {
                    displayHTML += `<img src="${userProfileImage}" alt="Profile" style="width: 40px; height: 40px; border-radius: 50%; border: 2px solid var(--primary); vertical-align: middle; margin-right: 8px;">`;
                }

                if (userNickname) {
                    displayHTML += `<span>${userNickname}ã•ã‚“ã¯</span>`;
                    if (twitterUsername) {
                        displayHTML += `<span style="font-size: 13px; color: #888; margin-left: 4px;">(@${twitterUsername})</span>`;
                    }
                }

                nicknameDisplayEl.innerHTML = displayHTML;
                nicknameDisplayEl.style.display = 'block';
            } else {
                nicknameDisplayEl.style.display = 'none';
            }

            // ãƒ¬ã‚¢åº¦è¡¨ç¤º
            const rarityBadge = document.getElementById('rarityBadge');
            if (result.rarityLevel === 'æ¿€ãƒ¬ã‚¢') {
                rarityBadge.innerHTML = 'â­ æ¿€ãƒ¬ã‚¢ â­';
                rarityBadge.style.background = 'linear-gradient(135deg, #FF6B6B, #FF8E53)';
            } else if (result.rarityLevel === 'ãƒ¬ã‚¢') {
                rarityBadge.innerHTML = 'âœ¨ ãƒ¬ã‚¢ âœ¨';
                rarityBadge.style.background = 'linear-gradient(135deg, #9C27B0, #E91E63)';
            } else if (result.rarityLevel === 'ãµã¤ã†') {
                rarityBadge.innerHTML = 'ğŸ”¹ ãµã¤ã† ğŸ”¹';
                rarityBadge.style.background = 'linear-gradient(135deg, #2196F3, #00BCD4)';
                rarityBadge.style.animation = 'none'; // pulseãªã—
            } else {
                rarityBadge.innerHTML = 'ğŸŒ¿ ã‚ˆãã„ã‚‹ ğŸŒ¿';
                rarityBadge.style.background = 'linear-gradient(135deg, #4CAF50, #8BC34A)';
                rarityBadge.style.animation = 'none'; // pulseãªã—
            }

            document.getElementById('rarityPercent').textContent = result.rarity + '%';
            document.getElementById('rarityPercent').style.color = result.rarityColor;

            // ç§°å·ãƒ»ãƒãƒƒã‚¸
            document.getElementById('badgeDisplay').textContent = result.badge;
            document.getElementById('badgeDisplay').style.color = result.rarityColor;

            // ã‚­ãƒ£ãƒƒãƒãƒ•ãƒ¬ãƒ¼ã‚º
            document.getElementById('catchPhrase').textContent = result.catchPhrase;
            document.getElementById('catchPhrase').style.borderColor = result.rarityColor;
            document.getElementById('catchPhrase').style.color = result.rarityColor;

            // ãƒã‚¤ãƒ©ãƒ«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
            document.getElementById('viralMessage').textContent = result.viralMessage;

            const traitsList = document.getElementById('resultTraits');
            traitsList.innerHTML = result.traits.map(trait => `<li>${trait}</li>`).join('');

            // Show RIASEC code and confidence
            document.getElementById('riasecCode').textContent = riasecCode;
            document.getElementById('riasecDetails').textContent = riasecDetails;
            document.getElementById('confidenceLevel').textContent = confidence + '%';
            document.getElementById('confidenceBar').style.width = confidence + '%';

            // === RIASECå…­è§’å½¢ãƒãƒ£ãƒ¼ãƒˆã®æç”» ===
            drawRiasecHexagon(riasecScores);

            // === RIASECè©³ç´°ã‚¹ã‚³ã‚¢ã®è¡¨ç¤º ===
            displayRiasecBreakdown(riasecScores);

            // Confidence level color
            const confidenceBar = document.getElementById('confidenceBar');
            if (confidence >= 85) {
                confidenceBar.style.background = '#00C896';
            } else if (confidence >= 70) {
                confidenceBar.style.background = '#0066FF';
            } else {
                confidenceBar.style.background = '#FF6B6B';
            }

            // Show theoretical basis
            document.getElementById('scheinAnchor').textContent = result.theoreticalBasis.schein;
            document.getElementById('hollandCode').textContent = result.theoreticalBasis.holland;
            document.getElementById('theoreticalExplanation').textContent = result.theoreticalBasis.explanation;

            document.getElementById('ctaTitle').textContent = result.ctaTitle;
            document.getElementById('ctaDescription').textContent = result.ctaDescription;
            document.getElementById('ctaButton').textContent = result.ctaButton;
            document.getElementById('ctaButton').href = result.ctaLink;

            document.getElementById('resultScreen').classList.add('active');

            window.currentResult = result;
            window.currentRiasecCode = riasecCode;
            window.currentConfidence = confidence;
            window.currentRiasecScores = riasecScores;
            window.currentNickname = userNickname || 'ã‚²ã‚¹ãƒˆ';
            window.currentProfileImageUrl = userProfileImage || '';
            window.currentTwitterUsername = twitterUsername || '';
            window.currentCombatPower = combatPowerData; // Save for share/image logic

            // === å¹³å‡å€¤ã¨ã®æ¯”è¼ƒã‚’è¡¨ç¤º ===
            loadAndDisplayAverageComparison(riasecScores);

            // === Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ãƒ‡ãƒ¼ã‚¿é€ä¿¡ ===
            saveToGoogleSheets(result, riasecCode, riasecScores, confidence);
        }

        // å¹³å‡å€¤ã‚’å–å¾—ã—ã¦æ¯”è¼ƒè¡¨ç¤ºã™ã‚‹é–¢æ•°
        async function loadAndDisplayAverageComparison(myScores) {
            if (!GOOGLE_SHEETS_URL) {
                return;
            }

            try {
                const response = await fetch(`${GOOGLE_SHEETS_URL}?action=stats`);
                const data = await response.json();

                if (data.success && data.totalCount > 0) {
                    displayAverageComparison(myScores, data.averageRiasec, data.totalCount);
                }
            } catch (error) {
                console.error('çµ±è¨ˆæƒ…å ±ã®å–å¾—ã‚¨ãƒ©ãƒ¼:', error);
            }
        }

        // å¹³å‡å€¤ã¨ã®æ¯”è¼ƒã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
        function displayAverageComparison(myScores, avgScores, totalCount) {
            // RIASECãƒãƒ£ãƒ¼ãƒˆã«å¹³å‡å€¤ã®ç·šã‚’è¿½åŠ 
            const canvas = document.getElementById('riasecChart');
            if (!canvas) {
                console.log('riasecChartè¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ï¼ˆå¹³å‡æ¯”è¼ƒæ©Ÿèƒ½ã¯ç„¡åŠ¹ï¼‰');
                return;
            }
            const ctx = canvas.getContext('2d');

            // å¹³å‡å€¤ã®å…­è§’å½¢ã‚’æç”»ï¼ˆç‚¹ç·šã€ã‚°ãƒ¬ãƒ¼ï¼‰
            ctx.strokeStyle = '#999';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]); // ç‚¹ç·š

            const centerX = 140;
            const centerY = 140;
            const maxRadius = 120;
            const dimensions = ['R', 'I', 'A', 'S', 'E', 'C'];

            ctx.beginPath();
            dimensions.forEach((dim, i) => {
                const angle = (Math.PI * 2 / 6) * i - Math.PI / 2;
                const avgValue = avgScores[dim] || 0;
                const radius = (avgValue / 15) * maxRadius; // 15ãŒæœ€å¤§å€¤
                const x = centerX + radius * Math.cos(angle);
                const y = centerY + radius * Math.sin(angle);

                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.closePath();
            ctx.stroke();
            ctx.setLineDash([]); // ç‚¹ç·šè§£é™¤

            // å¹³å‡å€¤ã¨ã®æ¯”è¼ƒæƒ…å ±ã‚’è¡¨ç¤º
            const comparisonHTML = `
                <div style="background: linear-gradient(135deg, #f5f7fa, #c3cfe2); padding: 20px; border-radius: 12px; margin-top: 24px;">
                    <div style="font-size: 18px; font-weight: 700; color: #333; margin-bottom: 12px; text-align: center;">
                        ğŸ“Š ã“ã‚Œã¾ã§ã®å›ç­”è€…ã¨ã®æ¯”è¼ƒï¼ˆ${totalCount}äººï¼‰
                    </div>
                    <div style="font-size: 13px; color: #666; text-align: center; margin-bottom: 16px;">
                        ã‚°ãƒ©ãƒ•ã®<span style="color: var(--primary); font-weight: 600;">é’ã„ç·š</span>ãŒã‚ãªãŸã€<span style="color: #999; font-weight: 600;">ç°è‰²ã®ç‚¹ç·š</span>ãŒå¹³å‡å€¤ã§ã™
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; font-size: 13px;">
                        ${dimensions.map(dim => {
                const myValue = myScores[dim] || 0;
                const avgValue = avgScores[dim] || 0;
                const diff = myValue - avgValue;
                const diffText = diff > 0 ? `+${diff.toFixed(1)}` : diff.toFixed(1);
                const diffColor = diff > 0 ? '#00C896' : (diff < 0 ? '#FF6B6B' : '#999');
                const dimNames = {
                    R: 'ç¾å®Ÿçš„', I: 'ç ”ç©¶çš„', A: 'èŠ¸è¡“çš„',
                    S: 'ç¤¾ä¼šçš„', E: 'ä¼æ¥­çš„', C: 'æ…£ç¿’çš„'
                };
                return `
                                <div style="background: white; padding: 12px; border-radius: 8px; text-align: center;">
                                    <div style="font-weight: 600; color: #333; margin-bottom: 4px;">${dim} (${dimNames[dim]})</div>
                                    <div style="font-size: 16px; font-weight: 700; color: var(--primary);">ã‚ãªãŸ: ${myValue}</div>
                                    <div style="font-size: 12px; color: #666;">å¹³å‡: ${avgValue.toFixed(1)}</div>
                                    <div style="font-size: 14px; font-weight: 700; color: ${diffColor}; margin-top: 4px;">${diffText}</div>
                                </div>
                            `;
            }).join('')}
                    </div>
                </div>
            `;

            // RIASECã‚°ãƒ©ãƒ•ã®å¾Œã«æŒ¿å…¥
            const riasecSection = document.querySelector('#riasecChart').parentElement;
            const comparisonDiv = document.createElement('div');
            comparisonDiv.innerHTML = comparisonHTML;
            riasecSection.after(comparisonDiv);
        }

        // Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã™ã‚‹é–¢æ•°
        async function saveToGoogleSheets(result, riasecCode, riasecScores, confidence) {
            // Google Sheets URLãŒè¨­å®šã•ã‚Œã¦ã„ãªã„å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—
            if (!GOOGLE_SHEETS_URL) {
                console.log('Google Sheets URL is not configured. Skipping data save.');
                return;
            }

            try {
                const data = {
                    timestamp: new Date().toISOString(),
                    nickname: userNickname || '',
                    twitterUsername: twitterUsername || '',
                    profileImageUrl: userProfileImage || '',
                    experienceLevel: experienceLevel || '',
                    resultType: result.type || '',
                    riasecCode: riasecCode || '',
                    riasecScores: riasecScores,
                    confidence: confidence || 0,
                    rarity: result.rarity || 0,
                    rarityLevel: result.rarityLevel || '',
                    careerAnchor: result.theoreticalBasis?.careerAnchors || '',
                    badge: result.badge || '',
                    userPath: userPath,
                    userAnswers: userAnswers, // å…¨ã¦ã®å›ç­”ã‚’é€ä¿¡
                    userAgent: navigator.userAgent,
                    referrer: document.referrer
                };

                // ãƒ‡ãƒãƒƒã‚°: é€ä¿¡ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèª
                console.log('é€ä¿¡ãƒ‡ãƒ¼ã‚¿:', data);
                console.log('å›ç­”æ•°:', Object.keys(userAnswers).length);

                const response = await fetch(GOOGLE_SHEETS_URL, {
                    method: 'POST',
                    mode: 'no-cors', // Google Apps Scriptã®åˆ¶ç´„ã«ã‚ˆã‚Šå¿…è¦
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });

                // no-corsãƒ¢ãƒ¼ãƒ‰ã§ã¯ response.ok ãŒä½¿ãˆãªã„ãŸã‚ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯é™å®šçš„
                console.log('è¨ºæ–­ãƒ‡ãƒ¼ã‚¿ã‚’Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«é€ä¿¡ã—ã¾ã—ãŸ');

            } catch (error) {
                console.error('Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã¸ã®é€ä¿¡ã‚¨ãƒ©ãƒ¼:', error);
                // ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã‚‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã‚’æãªã‚ãªã„ã‚ˆã†ã€ã‚µã‚¤ãƒ¬ãƒ³ãƒˆã«å‡¦ç†
            }
        }

        function drawRiasecHexagon(scores) {
            // å…­è§’å½¢ã®å„é ‚ç‚¹ã®åº§æ¨™ã‚’è¨ˆç®—
            const centerX = 140;
            const centerY = 130;
            const maxRadius = 90; // ä¸­å¿ƒã‹ã‚‰æœ€å¤–å‘¨ã¾ã§ã®è·é›¢

            // æœ€å¤§ã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—ï¼ˆæ­£è¦åŒ–ç”¨ï¼‰
            const maxScore = Math.max(...Object.values(scores), 1);

            // RIASECå„æ¬¡å…ƒã®è§’åº¦ï¼ˆåº¦ï¼‰- Rã‚’ä¸Šï¼ˆ-90åº¦ï¼‰ã‹ã‚‰æ™‚è¨ˆå›ã‚Š
            const angles = {
                R: -90,    // ä¸Š
                I: -30,    // å³ä¸Š
                A: 30,     // å³ä¸‹
                S: 90,     // ä¸‹
                E: 150,    // å·¦ä¸‹
                C: 210     // å·¦ä¸Š
            };

            // å„æ¬¡å…ƒã®ã‚¹ã‚³ã‚¢ã«åŸºã¥ã„ãŸåº§æ¨™ã‚’è¨ˆç®—
            const points = Object.keys(angles).map(dimension => {
                const score = scores[dimension] || 0;
                const normalizedScore = score / maxScore; // 0-1ã«æ­£è¦åŒ–
                const radius = maxRadius * normalizedScore;
                const angle = angles[dimension] * (Math.PI / 180); // ãƒ©ã‚¸ã‚¢ãƒ³ã«å¤‰æ›

                const x = centerX + radius * Math.cos(angle);
                const y = centerY + radius * Math.sin(angle);

                return `${x},${y}`;
            });

            // SVGãƒãƒªã‚´ãƒ³ã‚’æ›´æ–°
            document.getElementById('riasecDataPolygon').setAttribute('points', points.join(' '));
        }

        function displayRiasecBreakdown(scores) {
            const dimensions = {
                R: { name: 'ç¾å®Ÿçš„ï¼ˆRï¼‰', description: 'æ‰‹ã‚’å‹•ã‹ã—ã¦å…·ä½“çš„ãªæˆæœã‚’å‡ºã™', emoji: 'ğŸ”§' },
                I: { name: 'ç ”ç©¶çš„ï¼ˆIï¼‰', description: 'åˆ†æãƒ»ç ”ç©¶ãƒ»è«–ç†çš„æ€è€ƒ', emoji: 'ğŸ”¬' },
                A: { name: 'èŠ¸è¡“çš„ï¼ˆAï¼‰', description: 'å‰µé€ çš„ãƒ»ç‹¬å‰µçš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ', emoji: 'ğŸ¨' },
                S: { name: 'ç¤¾ä¼šçš„ï¼ˆSï¼‰', description: 'äººã‚’åŠ©ã‘ã‚‹ãƒ»ã‚µãƒãƒ¼ãƒˆ', emoji: 'ğŸ¤' },
                E: { name: 'ä¼æ¥­çš„ï¼ˆEï¼‰', description: 'å–¶æ¥­ãƒ»ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—', emoji: 'ğŸ“ˆ' },
                C: { name: 'æ…£ç¿’çš„ï¼ˆCï¼‰', description: 'æ­£ç¢ºãƒ»ä½“ç³»çš„ãªæ¥­å‹™', emoji: 'ğŸ“‹' }
            };

            // ã‚¹ã‚³ã‚¢ã‚’é™é †ã«ã‚½ãƒ¼ãƒˆ
            const sortedScores = Object.entries(scores).sort((a, b) => b[1] - a[1]);

            const breakdownHTML = sortedScores.map(([dim, score], index) => {
                const info = dimensions[dim];
                const isTop3 = index < 3;
                const bgColor = isTop3 ? 'linear-gradient(135deg, #e3f2fd, #fff3e0)' : '#f9f9f9';
                const borderColor = isTop3 ? '#2196F3' : '#e0e0e0';
                const fontWeight = isTop3 ? '700' : '600';

                return `
                    <div style="background: ${bgColor}; padding: 10px; border-radius: 8px; border: 2px solid ${borderColor};">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                            <span style="font-weight: ${fontWeight}; color: #333;">${info.emoji} ${info.name}</span>
                            <span style="font-size: 18px; font-weight: 800; color: #0066FF;">${score.toFixed(1)}</span>
                        </div>
                        <div style="font-size: 11px; color: #666;">${info.description}</div>
                        ${isTop3 ? '<div style="font-size: 10px; color: #2196F3; margin-top: 4px; font-weight: 700;">â˜… TOP3</div>' : ''}
                    </div>
                `;
            }).join('');

            document.getElementById('riasecBreakdown').innerHTML = breakdownHTML;
        }

        // çµæœç”»åƒã‚’ç”Ÿæˆã™ã‚‹å…±é€šé–¢æ•°ï¼ˆCanvasã‚’è¿”ã™ï¼‰- ã‚¯ãƒªãƒ¼ãƒ³ãªãƒ‡ã‚¶ã‚¤ãƒ³
        async function generateResultImage() {
            const result = window.currentResult;
            const riasecCode = window.currentRiasecCode || '';
            const riasecScores = window.currentRiasecScores;
            const nickname = window.currentNickname || 'ã‚²ã‚¹ãƒˆ';
            const profileImageUrl = window.currentProfileImageUrl;
            const twitterUser = window.currentTwitterUsername || '';

            // Canvasã‚’ä½œæˆï¼ˆç¸¦é•·ã€ä½™ç™½å¤šã‚ï¼‰
            const canvas = document.createElement('canvas');
            canvas.width = 1080;
            canvas.height = 1920;
            const ctx = canvas.getContext('2d');

            // èƒŒæ™¯ (ã‚¿ã‚¤ãƒ— x ãƒ©ãƒ³ã‚¯åˆ¥ã‚¢ãƒ‹ãƒ¡ç”»åƒ)
            // ç”Ÿæˆæ¸ˆã¿: Rank Cå…¨ç¨®, Rank B(practicitioner, expert, entrepreneur)
            // ãã®ä»–ã¯è¿‘ä¼¼ç”»åƒã¸ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
            const bgImageMap = {
                // Beginner
                'beginner_c': 'assets/type_beginner_rank_c_anime.png',
                'beginner_b': 'assets/type_beginner_rank_b_anime.png',
                'beginner_a': 'assets/type_beginner_rank_a_anime.png',
                'beginner_s': 'assets/type_beginner_rank_s_anime.png',

                // Practitioner
                'practitioner_c': 'assets/type_practitioner_rank_c_anime.png',
                'practitioner_b': 'assets/type_practitioner_rank_b_anime.png',
                'practitioner_a': 'assets/type_practitioner_rank_a_anime.png',
                'practitioner_s': 'assets/type_practitioner_rank_s_anime.png',

                // Expert
                'expert_c': 'assets/type_expert_rank_c_anime.png',
                'expert_b': 'assets/type_expert_rank_b_anime.png',
                'expert_a': 'assets/type_expert_rank_a_anime.png',
                'expert_s': 'assets/type_expert_rank_s_anime.png',

                // Entrepreneur
                'entrepreneur_c': 'assets/type_entrepreneur_rank_c_anime.png',
                'entrepreneur_b': 'assets/type_entrepreneur_rank_b_anime.png',
                'entrepreneur_a': 'assets/type_entrepreneur_rank_a_anime.png',
                'entrepreneur_s': 'assets/type_entrepreneur_rank_s_anime.png',
            };

            // ã‚¿ã‚¤ãƒ—ã¨ãƒ©ãƒ³ã‚¯ã®å–å¾—
            const resultKey = window.currentResultKey || 'beginner';
            const rankKey = window.currentCombatPower ? window.currentCombatPower.rank.toLowerCase() : 'c';

            // ä¸‹ä½äº’æ›ã¨ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ­ã‚¸ãƒƒã‚¯
            let bgUrl = bgImageMap[`${resultKey}_${rankKey}`];

            if (!bgUrl) {
                // ãã®ãƒ©ãƒ³ã‚¯ãŒãªã„å ´åˆã€Rank B -> Rank C ã®é †ã§æ¢ã™
                bgUrl = bgImageMap[`${resultKey}_b`] || bgImageMap[`${resultKey}_c`];
            }
            // ãã‚Œã§ã‚‚ãªã„å ´åˆï¼ˆBeginner Bãªã©ï¼‰ã€Beginner Cã¸
            if (!bgUrl && resultKey === 'beginner') {
                bgUrl = bgImageMap['beginner_c'];
            }

            try {
                // ç”»åƒèª­ã¿è¾¼ã¿
                const bgImg = await loadImage(bgUrl);
                // ç”»åƒãŒã‚ã‚‹å ´åˆï¼ˆã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã‚’ç¶­æŒã—ã¤ã¤ã‚«ãƒãƒ¼ï¼‰
                ctx.drawImage(bgImg, 0, 0, 1080, 1920);

                // ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ (æ–‡å­—ã‚’èª­ã¿ã‚„ã™ãã™ã‚‹ãŸã‚å°‘ã—æš—ã)
                ctx.fillStyle = 'rgba(0, 0, 0, 0.4)';
                ctx.fillRect(0, 0, 1080, 1920);

            } catch (e) {
                console.warn('èƒŒæ™¯ç”»åƒèª­ã¿è¾¼ã¿å¤±æ•—:', e);
                // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
                const gradient = ctx.createLinearGradient(0, 0, 1080, 1920);
                gradient.addColorStop(0, '#667eea');
                gradient.addColorStop(1, '#764ba2');
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, 1080, 1920);
            }

            // æ–‡å­—è‰²ã‚’ç™½ã«å¤‰æ›´ï¼ˆèƒŒæ™¯ãŒæš—ããªã‚‹ãŸã‚ï¼‰
            ctx.fillStyle = '#FFFFFF';

            let currentY = 120;

            // === ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒï¼ˆå¤§ããã€ä¸­å¤®ï¼‰ ===
            if (profileImageUrl) {
                try {
                    const img = await loadImage(profileImageUrl);
                    const size = 160;
                    ctx.save();
                    ctx.beginPath();
                    ctx.arc(540, currentY + size / 2, size / 2, 0, Math.PI * 2);
                    ctx.closePath();
                    ctx.clip();
                    ctx.drawImage(img, 540 - size / 2, currentY, size, size);
                    ctx.restore();

                    // å††ã®æ ç·šï¼ˆæ¥µè–„ï¼‰
                    ctx.strokeStyle = '#E0E0E0';
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.arc(540, currentY + size / 2, size / 2, 0, Math.PI * 2);
                    ctx.stroke();

                    currentY += size + 40;
                } catch (err) {
                    console.log('ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã®èª­ã¿è¾¼ã¿ã«å¤±æ•—');
                    currentY += 40;
                }
            } else {
                // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒãŒãªã„å ´åˆã¯ã‚¢ã‚¤ã‚³ãƒ³çµµæ–‡å­—ã‚’å¤§ããè¡¨ç¤º
                ctx.font = '140px sans-serif';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(result.icon, 540, currentY + 70);
                currentY += 180;
            }

            // ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ï¼ˆå¤§ããã€å¤ªå­—ï¼‰
            ctx.font = '700 56px system-ui, -apple-system, sans-serif';
            ctx.fillStyle = '#1A1A1A';
            ctx.textAlign = 'center';
            ctx.fillText(nickname, 540, currentY);
            currentY += 70;

            // Xãƒ¦ãƒ¼ã‚¶ãƒ¼åï¼ˆæ§ãˆã‚ï¼‰
            if (twitterUser) {
                ctx.font = '400 32px system-ui, -apple-system, sans-serif';
                ctx.fillStyle = '#999999';
                ctx.fillText(`@${twitterUser}`, 540, currentY);
                currentY += 60;
            } else {
                currentY += 20;
            }

            // ã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿ãƒ¼ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ãªç·šï¼‰
            ctx.strokeStyle = '#E0E0E0';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(340, currentY);
            ctx.lineTo(740, currentY);
            ctx.stroke();
            currentY += 80;

            // === è¨ºæ–­ã‚¿ã‚¤ãƒ—ï¼ˆå¤§ããï¼‰ ===
            ctx.font = '700 64px system-ui, -apple-system, sans-serif';
            ctx.fillStyle = '#1A1A1A';
            ctx.textAlign = 'center';
            ctx.fillText(result.type, 540, currentY);
            currentY += 90;

            // ãƒ¬ã‚¢åº¦ï¼ˆã‚¢ã‚¯ã‚»ãƒ³ãƒˆã‚«ãƒ©ãƒ¼ï¼‰
            ctx.font = '600 40px system-ui, -apple-system, sans-serif';
            ctx.fillStyle = result.rarityColor || '#0066FF';
            ctx.fillText(`${result.rarityLevel} ${result.rarity}%`, 540, currentY);
            currentY += 80;

            // ãƒãƒƒã‚¸ï¼ˆæ§ãˆã‚ï¼‰
            ctx.font = '500 36px system-ui, -apple-system, sans-serif';
            ctx.fillStyle = '#666666';
            ctx.fillText(result.badge, 540, currentY);
            currentY += 80;

            // === æˆ¦é—˜åŠ› & ãƒ©ãƒ³ã‚¯ ===
            const power = window.currentCombatPower ? window.currentCombatPower.power.toLocaleString() : '???';
            const rank = window.currentCombatPower ? window.currentCombatPower.rank : '?';

            // èƒŒæ™¯ãƒœãƒƒã‚¯ã‚¹ (é»’ã£ã½ã„ã‚°ãƒ©ãƒ‡)
            const gradient = ctx.createLinearGradient(140, currentY, 940, currentY + 200);
            gradient.addColorStop(0, '#1a1a1a');
            gradient.addColorStop(1, '#2a2a2a');
            ctx.fillStyle = gradient;

            // è§’ä¸¸çŸ©å½¢ã‚’æç”» (roundRectã®äº’æ›æ€§ã®ãŸã‚ã€ã‚·ãƒ³ãƒ—ãƒ«ãªrectã«ã™ã‚‹ã‹polyfillã‚’ä½¿ã†ãŒã€æœ€æ–°ãƒ–ãƒ©ã‚¦ã‚¶ãªã‚‰OKã€‚å¿µã®ãŸã‚è‡ªå‰å®Ÿè£…ã¯é¿ã‘ã¦ã‚·ãƒ³ãƒ—ãƒ«ã«)
            ctx.beginPath();
            // ctx.roundRect(140, currentY, 800, 220, 20); // ä¸€éƒ¨ã®ç’°å¢ƒã§æœªå¯¾å¿œã®å¯èƒ½æ€§
            ctx.rect(140, currentY, 800, 220); // å®‰å…¨ç­–
            ctx.fill();

            // ãƒ©ãƒ™ãƒ«
            ctx.fillStyle = '#AAAAAA';
            ctx.textAlign = 'center';
            ctx.font = '700 24px system-ui, -apple-system, sans-serif';
            ctx.fillText('POTENTIAL POWER', 540, currentY + 50);

            // ãƒ‘ãƒ¯ãƒ¼æ•°å€¤
            ctx.fillStyle = '#FFD700';
            ctx.font = '900 100px "Arial Black", "Impact", sans-serif';
            // å½±ã‚’ã¤ã‘ã‚‹
            ctx.shadowColor = 'rgba(255, 215, 0, 0.5)';
            ctx.shadowBlur = 20;
            ctx.fillText(power, 540, currentY + 150);
            ctx.shadowBlur = 0; // ãƒªã‚»ãƒƒãƒˆ

            // ãƒ©ãƒ³ã‚¯ã‚¹ã‚¿ãƒ³ãƒ—
            ctx.save();
            ctx.translate(880, currentY + 110);
            ctx.rotate(15 * Math.PI / 180);
            ctx.fillStyle = rank === 'S' ? 'rgba(255, 215, 0, 0.3)' : 'rgba(255, 255, 255, 0.1)';
            ctx.font = '900 200px "Arial Black", "Impact", sans-serif';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(rank, 0, 0);
            ctx.restore();

            currentY += 280;

            // ã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿ãƒ¼
            ctx.strokeStyle = '#E0E0E0';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(340, currentY);
            ctx.lineTo(740, currentY);
            ctx.stroke();
            currentY += 80;

            // === RIASECã‚³ãƒ¼ãƒ‰ï¼ˆå¼·èª¿ï¼‰ ===
            ctx.font = '400 32px system-ui, -apple-system, sans-serif';
            ctx.fillStyle = '#999999';
            ctx.fillText('RIASEC CODE', 540, currentY);
            currentY += 50;

            ctx.font = '700 72px "Courier New", monospace';
            ctx.fillStyle = '#1A1A1A';
            ctx.fillText(riasecCode, 540, currentY);
            currentY += 100;

            // === RIASECå…­è§’å½¢ã‚°ãƒ©ãƒ• ===
            const dimensions = ['R', 'I', 'A', 'S', 'E', 'C'];
            const dimNames = {
                R: 'ç¾å®Ÿçš„', I: 'ç ”ç©¶çš„', A: 'èŠ¸è¡“çš„',
                S: 'ç¤¾ä¼šçš„', E: 'ä¼æ¥­çš„', C: 'æ…£ç¿’çš„'
            };

            const centerX = 540;
            const centerY = currentY + 240;
            const maxRadius = 200;

            // èƒŒæ™¯ã®å…­è§’å½¢ã‚°ãƒªãƒƒãƒ‰ï¼ˆ3æ®µéšï¼‰
            ctx.strokeStyle = '#F0F0F0';
            ctx.lineWidth = 1;
            for (let level = 1; level <= 3; level++) {
                ctx.beginPath();
                dimensions.forEach((dim, i) => {
                    const angle = (Math.PI * 2 / 6) * i - Math.PI / 2;
                    const radius = (level / 3) * maxRadius;
                    const x = centerX + radius * Math.cos(angle);
                    const y = centerY + radius * Math.sin(angle);
                    if (i === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                });
                ctx.closePath();
                ctx.stroke();
            }

            // è»¸ç·šï¼ˆä¸­å¿ƒã‹ã‚‰å„é ‚ç‚¹ã¸ï¼‰
            ctx.strokeStyle = '#F0F0F0';
            ctx.lineWidth = 1;
            dimensions.forEach((dim, i) => {
                const angle = (Math.PI * 2 / 6) * i - Math.PI / 2;
                const x = centerX + maxRadius * Math.cos(angle);
                const y = centerY + maxRadius * Math.sin(angle);
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.lineTo(x, y);
                ctx.stroke();
            });

            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¹ã‚³ã‚¢ã‚’å…­è§’å½¢ã§æç”»
            ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
            ctx.strokeStyle = '#1A1A1A';
            ctx.lineWidth = 3;
            ctx.beginPath();
            dimensions.forEach((dim, i) => {
                const angle = (Math.PI * 2 / 6) * i - Math.PI / 2;
                const score = riasecScores[dim] || 0;
                const radius = (score / 15) * maxRadius;
                const x = centerX + radius * Math.cos(angle);
                const y = centerY + radius * Math.sin(angle);
                if (i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            });
            ctx.closePath();
            ctx.fill();
            ctx.stroke();

            // å„æ¬¡å…ƒã®ãƒ©ãƒ™ãƒ«
            ctx.font = '600 28px system-ui, -apple-system, sans-serif';
            ctx.fillStyle = '#1A1A1A';
            ctx.textAlign = 'center';
            dimensions.forEach((dim, i) => {
                const angle = (Math.PI * 2 / 6) * i - Math.PI / 2;
                const labelRadius = maxRadius + 70;
                const x = centerX + labelRadius * Math.cos(angle);
                const y = centerY + labelRadius * Math.sin(angle);

                const score = riasecScores[dim] || 0;
                ctx.fillText(`${dim}`, x, y);
                ctx.font = '400 22px system-ui, -apple-system, sans-serif';
                ctx.fillStyle = '#999999';
                ctx.fillText(`${dimNames[dim]}`, x, y + 28);
                ctx.font = '700 32px system-ui, -apple-system, sans-serif';
                ctx.fillStyle = '#1A1A1A';
                ctx.fillText(`${score.toFixed(1)}`, x, y + 60);
                ctx.font = '600 28px system-ui, -apple-system, sans-serif';
            });

            currentY += 540;

            // === ãƒ•ãƒƒã‚¿ãƒ¼ ===
            ctx.font = '500 28px system-ui, -apple-system, sans-serif';
            ctx.fillStyle = '#CCCCCC';
            ctx.textAlign = 'center';
            ctx.fillText('ç¤¾åŠ´å£«Lab ã‚­ãƒ£ãƒªã‚¢è¨ºæ–­', 540, 1820);

            return canvas;
        }

        // ç”»åƒã‚’èª­ã¿è¾¼ã‚€ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
        function loadImage(url) {
            return new Promise((resolve, reject) => {
                const img = new Image();
                img.crossOrigin = 'anonymous'; // CORSã‚¨ãƒ©ãƒ¼å›é¿
                img.onload = () => resolve(img);
                img.onerror = reject;
                img.src = url;
            });
        }

        // ç”»åƒã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹é–¢æ•°
        async function copyImageToClipboard(canvas) {
            try {
                const blob = await new Promise(resolve => canvas.toBlob(resolve, 'image/png'));
                await navigator.clipboard.write([
                    new ClipboardItem({ 'image/png': blob })
                ]);
                return true;
            } catch (err) {
                console.error('ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã¸ã®ã‚³ãƒ”ãƒ¼ã«å¤±æ•—:', err);
                return false;
            }
        }

        // çµæœç”»åƒã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹é–¢æ•°
        async function downloadResultImage() {
            const result = window.currentResult;
            const canvas = await generateResultImage();

            // ç”»åƒã‚’Blobã«å¤‰æ›
            canvas.toBlob(async blob => {
                const file = new File([blob], `ç¤¾åŠ´å£«ã‚­ãƒ£ãƒªã‚¢è¨ºæ–­_${result.type}.png`, { type: 'image/png' });

                // ã‚¹ãƒãƒ›ã®å ´åˆ: Web Share APIã‚’ä½¿ç”¨
                if (navigator.share && navigator.canShare && navigator.canShare({ files: [file] })) {
                    try {
                        await navigator.share({
                            files: [file],
                            title: 'ç¤¾åŠ´å£«ã‚­ãƒ£ãƒªã‚¢è¨ºæ–­çµæœ',
                            text: `ç§ã®ã‚­ãƒ£ãƒªã‚¢ã‚¿ã‚¤ãƒ—ã¯ã€Œ${result.type}ã€ã§ã—ãŸï¼`
                        });
                        return;
                    } catch (err) {
                        console.log('å…±æœ‰ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸ:', err);
                    }
                }

                // PCã®å ´åˆ: é€šå¸¸ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `ç¤¾åŠ´å£«ã‚­ãƒ£ãƒªã‚¢è¨ºæ–­_${result.type}.png`;
                a.click();
                URL.revokeObjectURL(url);
            });
        }

        // Xã‚·ã‚§ã‚¢æ©Ÿèƒ½ï¼ˆãƒ†ã‚­ã‚¹ãƒˆã®ã¿ãƒ»ã‚·ãƒ³ãƒ—ãƒ«ç‰ˆï¼‰
        function shareTwitter() {
            const result = window.currentResult;
            const riasecCode = window.currentRiasecCode || '';
            const rarityEmoji = result.rarityLevel === 'æ¿€ãƒ¬ã‚¢' ? 'â­' : result.rarityLevel === 'ãƒ¬ã‚¢' ? 'âœ¨' : 'ğŸ”¹';

            // è¨ºæ–­ãƒ„ãƒ¼ãƒ«ã®URL (Dynamic OGPå¯¾å¿œç‰ˆ)
            // ç¾åœ¨ã®origin + /api/share ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä»˜ä¸
            const shareBaseUrl = new URL('/api/share', window.location.origin);
            // typeãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã¯ã‚­ãƒ¼ï¼ˆbeginner, etcï¼‰ã‚’æ¸¡ã™
            const typeKey = window.currentResultKey || 'beginner';
            shareBaseUrl.searchParams.set('type', typeKey);
            shareBaseUrl.searchParams.set('power', window.currentCombatPower ? window.currentCombatPower.power : 0);
            shareBaseUrl.searchParams.set('rank', window.currentCombatPower ? window.currentCombatPower.rank : 'C');
            shareBaseUrl.searchParams.set('name', window.currentNickname || 'ã‚²ã‚¹ãƒˆ');
            shareBaseUrl.searchParams.set('riasec', riasecCode);

            const shareUrl = shareBaseUrl.toString();

            // ã‚·ã‚§ã‚¢ãƒ†ã‚­ã‚¹ãƒˆï¼ˆ280æ–‡å­—ä»¥å†…ï¼‰
            // ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆæˆ¦é—˜åŠ›ï¼‰ã¨ãƒ©ãƒ³ã‚¯ã‚’å«ã‚ã‚‹
            const power = window.currentCombatPower ? window.currentCombatPower.power.toLocaleString() : '???';
            const rank = window.currentCombatPower ? window.currentCombatPower.rank : '?';

            // URLãŒã™ã§ã«æƒ…å ±ã‚’èªã£ã¦ã„ã‚‹ã®ã§ã€ãƒ†ã‚­ã‚¹ãƒˆã¯ã‚·ãƒ³ãƒ—ãƒ«ã«
            const text = `ç§ã®ç¤¾åŠ´å£«æˆ¦é—˜åŠ›ã¯ã€Œ${power}ã€ã§ã™â€¦ï¼
ãƒ©ãƒ³ã‚¯: ${rank} | ã‚¿ã‚¤ãƒ—: ${result.type}
${result.badge}

#ç¤¾åŠ´å£«ã‚­ãƒ£ãƒªã‚¢è¨ºæ–­ #ç¤¾åŠ´å£«`;

            // Xã‚¢ãƒ—ãƒªã‚’é–‹ãï¼ˆã‚¹ãƒãƒ›ãªã‚‰ã‚¢ãƒ—ãƒªã€PCãªã‚‰Webï¼‰
            // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯2é‡ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ãŒå¿…è¦ãªå ´åˆãŒã‚ã‚‹ãŒã€ã“ã“ã§ã¯æ¨™æº–ã®encodeURIComponentã§
            const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(shareUrl)}`;
            window.location.href = twitterUrl; // window.openã§ã¯ãªãlocation.hrefã§ã‚¢ãƒ—ãƒªé€£æº
        }

        function shareLine() {
            const result = window.currentResult;
            const baseUrl = window.location.origin + window.location.pathname;

            const text = `ç§ã®ç¤¾åŠ´å£«ã‚­ãƒ£ãƒªã‚¢ã‚¿ã‚¤ãƒ—ã¯ã€Œ${result.type}ã€ã§ã—ãŸï¼${result.badge}\n\nã‚ãªãŸã‚‚è¨ºæ–­ã—ã¦ã¿ã¦ï¼`;
            window.open(`https://social-plugins.line.me/lineit/share?url=${encodeURIComponent(baseUrl)}&text=${encodeURIComponent(text)}`, '_blank');
        }

        // æˆ¦é—˜åŠ›ã®è¨ˆç®—
        function calculateCombatPower(riasecScores, resultType, experienceLevel) {
            // åŸºç¤ç‚¹: RIASECãƒˆãƒ¼ã‚¿ãƒ«ã‚¹ã‚³ã‚¢ (Max 18 * 6 = 108)
            const totalRiasec = Object.values(riasecScores).reduce((a, b) => a + b, 0);

            // çµŒé¨“å€¤ãƒœãƒ¼ãƒŠã‚¹ (ãƒ•ãƒªãƒ¼ã‚¶æ§˜ãƒªã‚¹ãƒšã‚¯ãƒˆ)
            let basePower = 530000;

            // åŸºç¤å€¤ã‚’ã‚¹ã‚³ã‚¢ã«å¿œã˜ã¦å¤‰å‹•ã•ã›ã‚‹
            const randomFactor = Math.floor(Math.random() * 5000) * (totalRiasec % 10);

            // çµŒé¨“ãƒ¬ãƒ™ãƒ«è£œæ­£
            if (experienceLevel.includes('3å¹´ä»¥ä¸Š')) basePower += 320000; // 85ä¸‡è¶…ãˆ
            else if (experienceLevel.includes('1-3å¹´')) basePower += 150000; // 68ä¸‡
            else if (experienceLevel.includes('å–å¾—ã—ãŸã°ã‹ã‚Š')) basePower += 50000; // 58ä¸‡

            // RIASECã‚¹ã‚³ã‚¢è£œæ­£ (Max 108 * 2000 = +216,000)
            basePower += (totalRiasec * 2500);

            // ã‚¿ã‚¤ãƒ—åˆ¥ãƒœãƒ¼ãƒŠã‚¹ (ç‰¹æ€§ã«åˆã‚ã›ã¦)
            if (resultType === 'entrepreneur') basePower *= 1.15; // ç‹¬ç«‹ã¯ãƒã‚¤ãƒªã‚¹ã‚¯ãƒã‚¤ãƒªã‚¿ãƒ¼ãƒ³
            if (resultType === 'expert') basePower *= 1.1; // å°‚é–€å®¶ã¯å …å®Ÿã«é«˜ã„

            // æ¡æ•°ã‚’æ•´ãˆã‚‹
            let finalPower = Math.floor(basePower + randomFactor);
            if (finalPower > 999999) finalPower = 999999; // ä¸Šé™ã‚¯ãƒªãƒƒãƒ—

            // ãƒ©ãƒ³ã‚¯åˆ¤å®š
            let rank = 'C';
            let rankText = 'è¦‹ç¿’ã„ç´š';
            let rankClass = 'rank-b';

            if (finalPower >= 850000) { rank = 'S'; rankText = 'ä¼èª¬ç´š'; rankClass = 'rank-s'; }
            else if (finalPower >= 700000) { rank = 'A'; rankText = 'é”äººç´š'; rankClass = 'rank-a'; }
            else if (finalPower >= 500000) { rank = 'B'; rankText = 'å®Ÿå‹™å®¶ç´š'; rankClass = 'rank-b'; }
            else { rank = 'C'; rankText = 'é§†ã‘å‡ºã—'; rankClass = 'rank-b'; }

            return { power: finalPower, rank, rankText, rankClass };
        }

        function animateValue(id, start, end, duration) {
            if (start === end) return;
            const range = end - start;
            let current = start;
            const increment = end > start ? Math.max(1, Math.floor(range / 50)) : -1;
            const stepTime = Math.abs(Math.floor(duration / (range / increment)));
            const obj = document.getElementById(id);
            const timer = setInterval(function () {
                current += increment;
                if ((increment > 0 && current >= end) || (increment < 0 && current <= end)) {
                    current = end;
                    clearInterval(timer);
                }
                obj.innerHTML = current.toLocaleString();
            }, stepTime);
        }
    </script>
</body>

</html>